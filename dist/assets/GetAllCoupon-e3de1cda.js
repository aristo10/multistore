import{cL as Y,r,cN as e,cO as f,cM as O,cS as j}from"./vendor-3a94a37a.js";import{fe as T,ff as B,fg as I,fh as V,C as z,U as M,T as A,fi as L}from"./index-ed7845ca.js";import{C as U}from"./CommonDelete-4339174a.js";import{C as H}from"./CreateDrawer-a7af16b9.js";import{F as a,I as S,b as i,h as k,D as y,B as N,f as G,k as R,M as J}from"./vendor-large-f75deccb.js";const K=()=>{const l=Y(),{Title:d}=G,[n]=a.useForm(),[c,s]=r.useState(!1),u=()=>{s(!0)},m=async t=>{try{(await l(T(t))).payload.message==="success"&&(s(!1),n.resetFields())}catch{s(!1)}},p=t=>{s(!1)};return e.jsx(r.Fragment,{children:e.jsxs("div",{className:" h-full",children:[e.jsx(d,{level:4,className:"m-2 text-center",children:"Create Coupon"}),e.jsxs(a,{form:n,layout:"vertical",className:"sm:mx-10",initialValues:{remember:!0,startDate:f()},onFinish:m,onFinishFailed:p,autoComplete:"off",labelAlign:"left",children:[e.jsx(a.Item,{style:{marginBottom:"10px"},label:"Coupon Code",name:"couponCode",rules:[{required:!0,message:"Please input coupon code!"}],children:e.jsx(S,{placeholder:"Enter coupon code"})}),e.jsx(a.Item,{style:{marginBottom:"10px"},label:"Type",name:"type",rules:[{required:!0,message:"Please select coupon type!"}],children:e.jsxs(i,{placeholder:"Select type",children:[e.jsx(i.Option,{children:"Percentage"},"percentage"),e.jsx(i.Option,{children:"Flat"},"flat")]})}),e.jsx(a.Item,{style:{marginBottom:"10px"},label:"Value",name:"value",rules:[{required:!0,message:"Please input coupon value!"}],children:e.jsx(k,{size:"small",placeholder:"15"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(a.Item,{label:"Start Date",required:!0,className:"w-1/2",name:"startDate",rules:[{required:!0,message:"Please input Start Date!"}],children:e.jsx(y,{label:"StartDate",size:"small",format:"YYYY-MM-DD"})}),e.jsx(a.Item,{label:"End Date",required:!0,className:"w-1/2",name:"endDate",rules:[{required:!0,message:"Please input End Date!"}],children:e.jsx(y,{label:"endDate",size:"small",format:"YYYY-MM-DD"})})]}),e.jsx(a.Item,{style:{marginBottom:"10px"},className:"flex justify-center mt-[24px]",children:e.jsx(N,{loading:c,type:"primary",htmlType:"submit",shape:"round",onClick:u,children:"Create Coupon"})})]})]})})};function Q({data:l,id:d}){const n=Y(),{couponCode:c,type:s,value:u,startDate:m,endDate:p}=l,[t]=a.useForm(),[x,h]=r.useState(),[C,o]=r.useState(!1),[D,g]=r.useState({couponCode:c,type:s,value:u,startDate:f(m,"YYYY-MM-DD"),endDate:f(p,"YYYY-MM-DD")}),v=()=>{o(!0)},q=()=>{o(!1)},w=()=>{o(!1)},F=async b=>{const E={...b,startDate:f(b.startDate).format("YYYY-MM-DD"),endDate:f(b.endDate).format("YYYY-MM-DD")};await n(B({id:d,values:E})),o(!1),h(!1)},P=()=>{h(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{onClick:v,className:"flex items-center gap-2 cursor-pointer",children:[e.jsx(R,{className:"gray-600  rounded-md"}),"Edit"]}),e.jsx(J,{title:"Edit Coupon",open:C,onOk:q,onCancel:w,footer:!1,children:e.jsxs(a,{form:t,layout:"vertical",className:"sm:mx-10",initialValues:D,onFinish:F,onFinishFailed:P,autoComplete:"off",labelAlign:"left",children:[e.jsx(a.Item,{style:{marginBottom:"10px"},label:"Coupon Code",name:"couponCode",rules:[{required:!0,message:"Please input coupon code!"}],children:e.jsx(S,{placeholder:"Select coupon code"})}),e.jsx(a.Item,{style:{marginBottom:"10px"},label:"Type",name:"type",required:!0,children:e.jsxs(i,{children:[e.jsx(i.Option,{children:"Percentage"},"percentage"),e.jsx(i.Option,{children:"Flat"},"flat")]})}),e.jsx(a.Item,{style:{marginBottom:"10px"},label:"Value",name:"value",required:!0,rules:[{required:!0,message:"Please input coupon Value!"}],children:e.jsx(k,{size:"small",placeholder:"15"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(a.Item,{label:"Start Date",required:!0,className:"w-1/2",name:"startDate",rules:[{required:!0,message:"Please input Start Date!"}],children:e.jsx(y,{label:"StartDate",size:"small",format:"YYYY-MM-DD"})}),e.jsx(a.Item,{label:"End Date",required:!0,className:"w-1/2",name:"endDate",rules:[{required:!0,message:"Please input End Date!"}],children:e.jsx(y,{label:"endDate",size:"small",format:"YYYY-MM-DD"})})]}),e.jsx(a.Item,{style:{marginBottom:"10px"},className:"flex justify-center mt-[24px]",children:e.jsx(N,{loading:x,onClick:()=>h(!0),type:"primary",htmlType:"submit",shape:"round",children:"Update Coupon"})})]})})]})}const ee=()=>{const l=Y(),{list:d,loading:n,total:c}=O(t=>t.coupon),[s,u]=r.useState({page:1,count:10,status:"true"}),m=[{id:1,title:"ID",dataIndex:"id",key:"id"},{id:2,title:"Name",dataIndex:"couponCode",key:"couponCode"},{id:3,title:"Type",dataIndex:"type",key:"type"},{id:4,title:"Value",dataIndex:"value",key:"value"},{id:5,title:"Start Date",dataIndex:"startDate",key:"startDate",render:t=>j(t).format("ll"),renderCsv:t=>j(t).format("ll")},{id:6,title:"End Date",dataIndex:"endDate",key:"endDate",render:t=>j(t).format("ll"),renderCsv:t=>j(t).format("ll")},{id:7,title:"",dataIndex:"",key:"action",render:({couponCode:t,type:x,value:h,startDate:C,endDate:o,id:D,status:g})=>[{label:e.jsx(M,{permission:"update-coupon",children:e.jsx(Q,{data:{couponCode:t,type:x,value:h,startDate:C,endDate:o},id:D})}),key:"edit"},{label:e.jsx(U,{values:{id:D,status:g},title:g==="true"?"Hide":"Show",permission:"delete-coupon",deleteThunk:L,loadThunk:I,query:s,className:"bg-white text-black"}),key:"delete"}],csvOff:!0}],p=[{key:"status",label:"Status",type:"select",options:[{label:"Show",value:"true"},{label:"Hide",value:"false"}],className:"min-w-[85px] max-w-[150px]",popupClassName:"w-[100px]"}];return r.useEffect(()=>(l(I(s)),()=>{l(V())}),[l,s]),e.jsx(z,{className:"max-md:border-0 max-md:bg-white",bodyClass:"max-md:p-0 ",headClass:"border-none",title:"Coupons",extra:e.jsx(H,{permission:"create-coupon",title:"Create Coupon",width:35,children:e.jsx(K,{})}),children:e.jsx(M,{permission:"readAll-coupon",children:e.jsx(A,{list:d,columns:m,loading:n,total:c,setPageConfig:u,title:"Coupon List",filters:p,isSearch:!0})})})};export{ee as default};
