import{cN as t,cQ as u,cS as b,cM as C,cL as I,r as c,da as L,cU as B,cT as w,dt as z,dc as K}from"./vendor-3a94a37a.js";import{am as k,s as M,aZ as O,aX as A,h0 as G,h1 as H,C as g,bt as Q,L as V}from"./index-ed7845ca.js";import{L as F}from"./List-9eb27318.js";import{T as X,a as N}from"./Tabs-8f68912a.js";import{d as q}from"./DetailSale-7695696b.js";import{d as U,F as p,I as S,a as T,c as W,B as Z,n as J,k as Y}from"./vendor-large-f75deccb.js";import{s as _}from"./emailConfigSlice-145edc06.js";import{T as $}from"./TagInput-f33dd18b.js";import{textEditorModule as ee,textEditorFormats as te}from"./AddProduct-aa890cea.js";import{i as se}from"./invoiceGenerator-eaeb8720.js";import{u as oe}from"./useCurrency-4b14dd3d.js";import"./ViewBtn-ffc9b5cb.js";import"./SaleProductListCard-76fb09a1.js";import"./numberToWords-4c291141.js";import"./AddTransaction-603c2655.js";import"./AddAccount-8cfc0f4b.js";import"./BigDrawer-240149a9.js";import"./BtnLoader-1c0e147f.js";import"./ImageUploader-c0ae741f.js";import"./MediaGallery-5095f29f.js";import"./UploaderWithDrag-568744bd.js";import"./AddManufacturer-2f6bafee.js";import"./AddProductBrand-894ab785.js";import"./UploadMany-c4472299.js";import"./AddProductSubcategory-71762def.js";import"./AddProductCategory-6511f02f.js";import"./AddUoM-1dc09ff9.js";import"./AddVatTax-97a0925d.js";import"./FormProductListCard-571d2cbc.js";import"./AddProductAttribute-4ec2c5fe.js";import"./AddProductAttributeValue-d16feddc.js";import"./AddDiscount-05e89f9a.js";function ne({list:o,linkTo:n}){const l=[{id:1,title:"Invoice",dataIndex:"id",key:"id",render:(e,{id:a})=>t.jsx(u,{to:`/admin/sale/${a}`,children:a}),renderCsv:e=>e},{id:2,title:"Date",dataIndex:"date",key:"date",render:e=>b(e).format("ll"),renderCsv:e=>b(e).format("ll")},{id:4,title:"Total Amount",dataIndex:"totalAmount",key:"totalAmount",render:e=>Number(e).toFixed(2),renderCsv:e=>Number(e).toFixed(2)},{id:7,title:"Paid",dataIndex:"paidAmount",key:"paidAmount",render:e=>Number(e).toFixed(2),responsive:["md"],renderCsv:e=>Number(e).toFixed(2)},{id:6,title:"Due",dataIndex:"dueAmount",key:"dueAmount",render:e=>Number(e).toFixed(2),renderCsv:e=>Number(e).toFixed(2),responsive:["md"]},{id:5,title:"Due date",dataIndex:"dueDate",key:"discount",render:e=>e?t.jsxs("div",{className:"flex gap-1 items-center",children:[b(e).format("ll"),q(e)&&t.jsx(U,{className:"text-xs",color:"red",children:"Overdue"})]}):null,renderCsv:e=>Number(e).toFixed(2)},{id:8,title:"Profit",dataIndex:"profit",key:"profit",render:e=>Number(e).toFixed(2),renderCsv:e=>Number(e).toFixed(2),responsive:["md"]},{id:9,title:"Sale Person",dataIndex:"user",key:"user",render:e=>t.jsx(u,{to:`/admin/hrm/staff/${e==null?void 0:e.id}`,children:e==null?void 0:e.username}),renderCsv:e=>e==null?void 0:e.username,responsive:["md"]}],s=e=>e.map(a=>({...a,key:a.id}));return t.jsx("div",{className:"m-2",children:t.jsx(k,{scroll:{x:!0},loading:!o,columns:l,data:o?s(o):[]})})}const le=({list:o})=>{const n=[{title:"ID",dataIndex:"id",key:"id"},{title:"Date",dataIndex:"date",key:"date",render:s=>b(s).format("ll")},{title:"Total Amount",dataIndex:"totalAmount",key:"totalAmount"},{title:"Tax",dataIndex:"tax",key:"tax"},{title:"Note",dataIndex:"note",key:"note"},{title:"Sale Invoice No",dataIndex:"saleInvoiceId",key:"saleInvoiceId",render:s=>t.jsx(u,{to:`/admin/sale/${s}`,children:s})}],l=s=>s.map(e=>({...e,key:e.id}));return t.jsx("div",{className:"m-2",children:t.jsx(k,{scroll:{x:!0},columns:n,data:o?l(o):[]})})},re=({list:o})=>{const n=[{title:"ID",dataIndex:"id",key:"id",render:s=>t.jsx(u,{to:`/admin/transaction/${s}`,children:s})},{title:"Date",dataIndex:"date",key:"date",render:s=>b(s).format("ll")},{title:"Debit",dataIndex:"debit",key:"debit",render:s=>t.jsx(u,{to:`/admin/account/${s==null?void 0:s.id}`,children:s==null?void 0:s.name})},{title:"Credit",dataIndex:"credit",key:"credit",render:s=>t.jsx(u,{to:`/admin/account/${s==null?void 0:s.id}`,children:s==null?void 0:s.name})},{title:"Amount",dataIndex:"amount",key:"amount"},{title:"Type ",dataIndex:"type",key:"type"},{title:"Particulars",dataIndex:"particulars",key:"particulars",render:s=>t.jsx("div",{title:s,children:M(s,20)})}],l=s=>s.map(e=>({...e,key:e.id}));return t.jsx("div",{className:"m-2",children:t.jsx(k,{scroll:{x:!0},columns:n,data:o?l(o):[]})})};function ae({setSendEmail:o,data:n}){const l=C(i=>{var d;return(d=i==null?void 0:i.setting)==null?void 0:d.data})||null,s=`Customer Ledger - ${l==null?void 0:l.companyName}`,e=`
    <div>
      <p>Dear <strong>${n==null?void 0:n.username}</strong>,</p>
      <p>Greetings! We trust this message reaches you in great spirits.</p>
    </div>
    <br>
    <p>Here is the summary of your accounts:</p>
    <br>
    <div class="order-info">
      Total Amount: ${n==null?void 0:n.totalAmount}<br>
      Paid Amount: ${n==null?void 0:n.totalPaidAmount}<br>
      Return Amount: ${n==null?void 0:n.totalReturnAmount}<br>
      Due Amount: ${n==null?void 0:n.dueAmount}
    </div>
    <br>
    <div class="invoice-details">
      Total invoice count: ${n==null?void 0:n.totalSaleInvoice}<br>
      Total return invoice count: ${n==null?void 0:n.totalReturnSaleInvoice}<br>
    </div>
    <br>
    <div class="company-info">
      Best Regards,<br>
      <strong>${l==null?void 0:l.companyName}</strong><br>
      ${l==null?void 0:l.phone}<br>
      ${l==null?void 0:l.email}
    </div>
  `,[a]=p.useForm(),f=I(),[y,h]=c.useState(!1),[j,v]=c.useState([]),[x,r]=c.useState([]),[m,P]=c.useState(e),D=async i=>{h(!0);try{let d=new FormData;i.receiverEmail&&d.append("receiverEmail",i.receiverEmail),i.subject&&d.append("subject",i.subject),m&&d.append("body",m),j.length>0&&d.append("cc[]",j),x.length>0&&d.append("bcc[]",x),(await f(_(d))).payload.message==="success"&&(o(!1),h(!1),a.resetFields(),v([]),r([]))}catch(d){console.log(d)}h(!1)},R=()=>{},E=i=>{P(i)};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"py-4 px-4 border-t",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("p",{className:""}),t.jsx("button",{onClick:()=>o(!1),className:"bg-red-100 p-1 rounded text-red-500",children:t.jsx(L,{size:20})})]}),t.jsxs(p,{onFinish:D,onFinishFailed:R,colon:!1,layout:"vertical",form:a,initialValues:{subject:s,body:e,receiverEmail:n.email||""},children:[t.jsx(p.Item,{style:{width:"100%"},label:"To",rules:[{required:!0,message:"Please input receiver email!"}],name:"receiverEmail",children:t.jsx(S,{placeholder:"Receiver Email"})}),t.jsx(T,{bordered:!1,defaultActiveKey:["0"],expandIcon:({isActive:i})=>t.jsx(W,{rotate:i?90:0}),className:"site-collapse-custom-collapse mb-4 ",children:t.jsxs(T.Panel,{header:"CC & BCC",children:[t.jsx($,{label:"CC",tags:j,setTags:v}),t.jsx($,{label:"BCC",tags:x,setTags:r})]},"1")}),t.jsx(p.Item,{style:{width:"100%"},label:"Subject",name:"subject",children:t.jsx(S,{placeholder:"Subject"})}),t.jsx(p.Item,{style:{marginBottom:"25px"},label:"Body",children:t.jsx(B,{value:m,onChange:E,modules:ee,formats:te})}),t.jsx(p.Item,{children:t.jsx(Z,{loading:y,size:"large",htmlType:"submit",type:"primary",children:"Send"})})]})]})})}function ie({data:o,title:n}){var x;oe();const l=C(r=>{var m;return(m=r==null?void 0:r.setting)==null?void 0:m.data})||null,s=I(),e=[],a=[{label:"Total Amount",value:` ${o.totalAmount.toFixed(2)}`},{label:"Paid Amount",value:` ${o.totalPaidAmount.toFixed(2)}`},{label:"Return Amount",value:`${o.totalReturnAmount.toFixed(2)}`},{label:"Due Amount",value:`${o.dueAmount.toFixed(2)}`}],f=["SL","Invoice","Date","Amount","Paid","Due","Profit","Sale Person"],y=(x=o==null?void 0:o.saleInvoice)==null?void 0:x.map((r,m)=>[m+1,r.id,b(r.date).format("ll"),r.totalAmount,r.paidAmount,r.dueAmount,r.profit,`${r.user.firstName} ${r.user.lastName}`]),h=[{value:`Customer: ${o!=null&&o.username?o.username:"N/A"}`},{value:`Phone: ${o!=null&&o.phone?o.phone:"N/A"}`},{value:`Email: ${o!=null&&o.email?o.email:"N/A"}`}],j=[{value:`Address: ${o!=null&&o.address?o.address:"N/A"}`}],v={jsPDF:{},tableFontSize:10,infoTopFontSize:10,bottomRightFontSize:10,bottomLeftFontSize:8,footerFontSize:10};return c.useEffect(()=>{!l&&s(O())},[s,l]),t.jsx("div",{className:"",children:t.jsx(A,{color:"primary",onClick:()=>se("print",{title:n,TopRightInfo:j,customerInfo:h,companyInfo:l,bottomLeftContent:e,bottomRightContent:a,tableBody:y,tableHead:f,settings:v,leftBottomSecondColumnX:55}),children:"Print"})})}const Ge=()=>{const{id:o}=w(),n=I(),[l,s]=c.useState(!1),e=C(a=>a.customers.customer);return c.useEffect(()=>(n(G(o)),()=>{n(H())}),[o]),t.jsx(t.Fragment,{children:e?t.jsxs("div",{className:"flex gap-2 md:gap-4",children:[t.jsxs(g,{className:"w-2/3",bodyClass:"p-0",children:[t.jsx("div",{className:"flex justify-between mx-2 py-2 border-b items-center",children:t.jsxs("div",{className:" flex gap-3",children:[t.jsx("div",{children:t.jsx(ie,{title:"Customer Invoice List",data:e})}),t.jsx(A,{className:"flex-row-reverse",color:"gray",icon:t.jsx(z,{size:15}),onClick:()=>s(!0),children:"Send"}),t.jsx(J,{content:t.jsx(Q,{items:[{key:"status",label:t.jsxs(u,{className:"flex items-center gap-2",to:`/admin/customer/${e==null?void 0:e.id}/update`,state:{data:e},children:[t.jsx(Y,{}),"Edit"]})}]}),placement:"bottomRight",arrow:!1,trigger:"click",children:t.jsx(A,{color:"gray",icon:t.jsx(K,{size:15}),className:"  px-3"})})]})}),l?t.jsx(ae,{setSendEmail:s,data:e}):t.jsxs(X,{className:"mt-4",children:[t.jsx(N,{label:t.jsxs("span",{children:["Invoice"," ",t.jsx("span",{className:"ml-2 rounded-full bg-slate-300 text-slate-700 px-1",children:e==null?void 0:e.totalSaleInvoice})]}),children:t.jsx(ne,{list:e==null?void 0:e.saleInvoice,linkTo:"/admin/sale"})}),t.jsx(N,{label:t.jsxs("span",{children:["Return Invoice"," ",t.jsx("span",{className:"ml-2 rounded-full bg-slate-300 text-slate-700 px-1",children:e==null?void 0:e.totalReturnSaleInvoice})]}),children:t.jsx(le,{list:e==null?void 0:e.returnSaleInvoice})}),t.jsx(N,{label:"Transactions",children:t.jsx(re,{list:e==null?void 0:e.allTransaction})})]})]}),t.jsxs("div",{className:"w-1/3 flex flex-col gap-2 md:gap-4",children:[t.jsx(g,{title:"Customer Details",children:t.jsx(F,{labelClassName:"w-[30%]",list:[{label:"Name",value:e==null?void 0:e.username},{label:"Phone",value:e==null?void 0:e.phone},{label:"Email",value:e==null?void 0:e.email},{label:"Address",value:e==null?void 0:e.address}]})}),t.jsx(g,{children:t.jsx(F,{labelClassName:"w-[30%]",list:[{label:"Total Amount",value:e!=null&&e.totalAmount?Number(e.totalAmount).toFixed(2):0},{label:"Return Amount",value:t.jsx("div",{className:"before:content-['-'] relative before:absolute before:text-red-500 before:font-bold before:-left-3 before:top-0",children:e==null?void 0:e.totalReturnAmount})},{label:"Paid Amount",value:t.jsx("div",{className:"before:content-['-'] relative before:absolute before:text-red-500 before:font-bold before:-left-3 before:top-0",children:e==null?void 0:e.totalPaidAmount}),className:"border-b pb-1"},{label:"Due Amount",value:e==null?void 0:e.dueAmount}]})})]})]}):t.jsx(V,{})})};export{Ge as default};
