import{cN as e,cL as O,cM as w,r as m,cU as R,cT as q,cO as Q}from"./vendor-3a94a37a.js";import{Y as W,V as X,a1 as Y,c3 as _,S as J,fK as Z,a9 as ee,a5 as te,fL as ae,L as le,fM as re}from"./index-ed7845ca.js";import{I as se}from"./ImageUploader-c0ae741f.js";import{b as d,F as r,I as y,C as oe,w as ne,B as ie}from"./vendor-large-f75deccb.js";import{S as de,A as ce}from"./FormProductListCard-571d2cbc.js";import{B as S}from"./BigDrawer-240149a9.js";import{A as me}from"./AddManufacturer-2f6bafee.js";import{A as ue}from"./AddProductBrand-894ab785.js";import{A as pe}from"./AddProductCategory-6511f02f.js";import{A as xe}from"./AddUoM-1dc09ff9.js";import{A as F}from"./AddVatTax-97a0925d.js";import{textEditorModule as he,textEditorFormats as fe}from"./AddProduct-aa890cea.js";import"./MediaGallery-5095f29f.js";import"./UploaderWithDrag-568744bd.js";import"./AddProductAttribute-4ec2c5fe.js";import"./UploadMany-c4472299.js";import"./AddProductAttributeValue-d16feddc.js";import"./AddProductSubcategory-71762def.js";import"./AddDiscount-05e89f9a.js";const je=({name:p,data:I,attributeValue:c,attributeValueHandler:l})=>{var A;const x=I.filter(s=>s.status==="true").map(s=>({id:s.id,label:s.name,value:s.id})),B=s=>{l(p,[s])},j=((A=c[p])==null?void 0:A.map(s=>{var f;return(f=I.find(g=>g.id==s))==null?void 0:f.id}))||[];return e.jsx(d,{style:{width:"100%"},defaultValue:j[0],maxTagCount:0,options:x,placeholder:"Nothing Selected",onChange:B})};function ge({description:p,descriptionHandler:I}){const c=O(),{list:l,loading:u}=w(t=>t.productSubCategories),{list:x,loading:B}=w(t=>t.productBrands),{list:j,loading:A}=w(t=>t.uom),{list:s,loading:f}=w(t=>t.vatTax),{list:g,loading:N}=w(t=>t.manufacturer);return m.useEffect(()=>{c(W({page:1,count:100,status:!0})),c(X({page:1,count:100,status:!0})),c(Y()),c(_()),c(J())},[c]),e.jsxs(e.Fragment,{children:[e.jsx(r.Item,{style:{marginBottom:"15px"},label:"Group Name",name:"productGroupName",className:"w-full",children:e.jsx(y,{placeholder:"Enter group name"})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(r.Item,{style:{marginBottom:"15px"},name:"subCategoryId",label:e.jsxs(e.Fragment,{children:["Subcategory",e.jsx(S,{title:"new Sub-Category",children:e.jsx(pe,{drawer:!0})})]}),className:"w-full sm:w-1/2",children:e.jsx(d,{loading:u,showSearch:!0,placeholder:"Select Subcategory",optionFilterProp:"children",filterOption:(t,i)=>i.children.includes(t),filterSort:(t,i)=>t.children.toLowerCase().localeCompare(i.children.toLowerCase()),children:l==null?void 0:l.map(t=>e.jsx(d.Option,{value:t==null?void 0:t.id,children:t==null?void 0:t.name},t==null?void 0:t.id))})}),e.jsx(r.Item,{style:{marginBottom:"15px"},className:"flex-grow",name:"productBrandId",label:e.jsxs(e.Fragment,{children:["Brand",e.jsx(S,{title:"new Brand",children:e.jsx(ue,{drawer:!0})})]}),children:e.jsx(d,{name:"productBrandId",loading:B,showSearch:!0,placeholder:"Select Brand",optionFilterProp:"children",filterOption:(t,i)=>i.children.includes(t),filterSort:(t,i)=>t.children.toLowerCase().localeCompare(i.children.toLowerCase()),children:x==null?void 0:x.map(t=>e.jsx(d.Option,{value:t.id,children:t.name},t.id))})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(r.Item,{style:{marginBottom:"15px"},name:"uomId",label:e.jsxs(e.Fragment,{children:["UoM",e.jsx(S,{title:"UoM",children:e.jsx(xe,{})})]}),className:"w-full sm:w-1/2",children:e.jsx(d,{name:"uomId",loading:A,showSearch:!0,optionFilterProp:"children",filterOption:(t,i)=>i.children.includes(t),filterSort:(t,i)=>t.children.toLowerCase().localeCompare(i.children.toLowerCase()),children:j&&j.map(t=>e.jsx(d.Option,{value:t==null?void 0:t.id,children:t==null?void 0:t.name},t.id))})}),e.jsx(r.Item,{style:{marginBottom:"15px"},label:"UoM Value",name:"uomValue",className:"w-full sm:w-1/2",children:e.jsx(y,{type:"number"})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(r.Item,{style:{marginBottom:"15px"},label:e.jsxs(e.Fragment,{children:["Purchase VAT"," ",e.jsx(S,{title:"Vat/Tax",children:e.jsx(F,{})})]}),name:"productPurchaseTaxId",className:"w-full sm:w-1/2",children:e.jsx(d,{placeholder:"Select Vat/Tax type",loading:f,children:s==null?void 0:s.map(t=>e.jsxs(d.Option,{value:t.id,children:[t.title,e.jsxs("span",{className:"italic",children:["@",t.percentage,"%"]})]},t.id))})}),e.jsx(r.Item,{style:{marginBottom:"15px"},label:e.jsxs(e.Fragment,{children:["Sales VAT"," ",e.jsx(S,{title:"VAT/TAX",children:e.jsx(F,{})})]}),name:"productSalesTaxId",className:"w-full sm:w-1/2",children:e.jsx(d,{placeholder:"Select Vat/Tax type",loading:f,children:s==null?void 0:s.map(t=>e.jsxs(d.Option,{value:t.id,children:[t.title,e.jsxs("span",{className:"italic",children:["@",t.percentage,"%"]})]},t.id))})})]}),e.jsx(r.Item,{style:{marginBottom:"15px"},label:e.jsxs(e.Fragment,{children:["Manufacture",e.jsx(S,{title:"Manufacture",children:e.jsx(me,{})})]}),className:"w-full sm:w-1/2",name:"manufacturerId",children:e.jsx(d,{allowClear:!0,placeholder:"Select Manufacture",loading:N,children:g==null?void 0:g.map(t=>e.jsx(d.Option,{value:t.id,children:t.name},t.id))})}),e.jsx(r.Item,{style:{marginBottom:"25px"},label:"Product Description ",name:"description",children:e.jsx(R,{value:p,onChange:I,modules:he,formats:fe})})]})}const ke=()=>{const p=O(),[I]=r.useForm(),{id:c}=q(),{product:l}=w(a=>a.products),u=w(a=>{var n;return(n=a.productAttribute)==null?void 0:n.list}),x=w(a=>{var n;return(n=a.discount)==null?void 0:n.list}),[B,j]=m.useState(!1),[A,s]=m.useState([]),[f,g]=m.useState(""),[N,t]=m.useState([]),[i,C]=m.useState({}),[T,L]=m.useState([]),[D,U]=m.useState(),[V,M]=m.useState(!1),k=a=>{g(a)},E=a=>{s(a)},z=async a=>{var n;j(!0);try{let h={...a,productThumbnailImage:((n=A[0])==null?void 0:n.id)||null,productAttributeValueId:T};V&&f&&(h.description=f);const b=await p(re({values:h,id:c}))}catch{j(!1)}finally{j(!1)}},P=a=>{const h=Object.values(a).reduce((b,o)=>[...b,...o],[]);L(h)},G=a=>{const n=a.map(h=>u.find(o=>o.name===h));t(n)},K=(a,n)=>{const b=Object.keys(i).find(o=>o===a);if(b){const o={...i,[b]:n};C(o),P(o)}else{const o={...i,[a]:n};C(o),P(o)}},H=a=>{M(a.target.checked)};return m.useEffect(()=>{p(Z(c)),p(ee()),p(te())},[p,c]),m.useEffect(()=>{l&&(g(l==null?void 0:l.description),l!=null&&l.productThumbnailImage&&s([{id:l==null?void 0:l.productThumbnailImage}]))},[l]),m.useEffect(()=>{if(l&&u){const a=ae(l==null?void 0:l.productProductAttributeValue);let n={};a.forEach(o=>{var v;n[(v=o[0].productAttributeValue.productAttribute)==null?void 0:v.name]=o.map($=>$.productAttributeValueId)});const h=a.map(o=>o[0].productAttributeValue.productAttribute.id),b=u.filter(o=>h.includes(o.id));t(b),C(n),U(!0)}},[u,l]),e.jsx(e.Fragment,{children:l?e.jsxs(oe,{className:"border-0 md:border md:p-6 bg-transparent md:bg-[#fafafa]",bodyStyle:{padding:0},bordered:!1,children:[e.jsx("h1",{className:"text-lg font-bold text-center my-4",children:"Update Product"}),e.jsxs(r,{form:I,name:"basic",className:"mx-4",initialValues:{...l,...l.productGroup,expDate:l.expDate&&Q(l.expDate)},onFinish:z,layout:"vertical",children:[e.jsx(r.Item,{style:{marginBottom:"15px"},label:"Name",name:"name",required:!0,children:e.jsx(y,{})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(de,{name:"sku",className:"w-full sm:w-1/2",isUpdate:!0,initialSku:l.sku}),e.jsx(r.Item,{style:{marginBottom:"15px"},label:"Discount",name:"discountId",className:"w-full sm:w-1/2",children:e.jsx(d,{loading:!x,showSearch:!0,placeholder:"Select discount",optionFilterProp:"children",children:x==null?void 0:x.map(a=>e.jsx(d.Option,{value:a.id,children:`${a.type=="percentage"?`${a.value}%`:`Flat ${a.value}`}`},a.id))})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(r.Item,{label:"UPC No",name:"upcNo",className:"w-full sm:w-1/2",children:e.jsx(y,{size:"small",placeholder:"Universal product code"})}),e.jsx(r.Item,{label:"EAN No",name:"eanNo",className:"w-full sm:w-1/2",children:e.jsx(y,{size:"small",placeholder:"International article number"})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(r.Item,{label:"ISBN No",name:"isbnNo",className:"w-full sm:w-1/2",children:e.jsx(y,{size:"small",placeholder:"International standard book number"})}),e.jsx(r.Item,{label:"Part No",name:"partNo",className:"w-full sm:w-1/2",children:e.jsx(y,{size:"small",placeholder:"Part number"})})]}),(u==null?void 0:u.length)&&D&&e.jsx(r.Item,{style:{marginBottom:"15px"},label:"Attributes",children:e.jsx(ce,{data:u,attributes:N,attributesHandler:G})}),e.jsx("div",{className:"border-l border-blue-300",children:N==null?void 0:N.map(a=>e.jsx(r.Item,{style:{marginBottom:"15px",marginLeft:"20px"},label:a.name,name:a.name.toLowerCase(),children:e.jsx(je,{name:a.name,data:a.productAttributeValue,attributeValueHandler:K,attributeValue:i})},a.id))}),e.jsx(r.Item,{label:"Thumbnail Image",valuePropName:"gallery_image",className:"w-full",tooltip:"Image size should be less than 2MB.",children:e.jsx(se,{images:A,setImages:E,filter:{image:"image"}})}),e.jsx(ne,{checked:V,onChange:H,className:"my-2",children:"Want to update group info?"}),V&&e.jsx(ge,{description:f,descriptionHandler:k}),e.jsx(r.Item,{style:{marginBottom:"15px"},className:"flex justify-center mt-[24px]",children:e.jsx(ie,{type:"primary",htmlType:"submit",shape:"round",loading:B,children:"Update Product"})})]})]}):e.jsx(le,{})})};export{ke as default};
