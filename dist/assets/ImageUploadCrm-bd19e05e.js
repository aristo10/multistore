import{r as a,cN as s,cQ as g,cS as f,cL as w,dd as N}from"./vendor-3a94a37a.js";import{C as v,U as p,am as C}from"./index-ed7845ca.js";import{A as x}from"./AddOpportunity-ee63437e.js";import{P as S,e as h}from"./vendor-large-f75deccb.js";import{M as k}from"./MediaGallery-5095f29f.js";function P({data:e,loading:m,name:u,singleLoadThunk:o}){const[i,l]=a.useState(!1),[c,d]=a.useState(!1),n=()=>{l(!1)},r=()=>{d(!1)},j=[{title:"Name",key:"Opportunity Name",render:({opportunityName:t,id:y})=>s.jsx(g,{to:`/admin/crm/opportunity/${y}`,children:t})},{title:"Amount",dataIndex:"amount",key:"amount"},{title:"Stage",key:"Stage",dataIndex:"opportunityStage",render:t=>t==null?void 0:t.opportunityStageName},{title:"Type",dataIndex:"opportunityType",key:"opportunityType",render:t=>t==null?void 0:t.opportunityTypeName},{title:"Source",dataIndex:"opportunitySource",key:"opportunitySource",render:t=>t==null?void 0:t.opportunitySourceName},{title:"Create date",dataIndex:"createdAt",key:"createdAt",render:t=>f(t).format("MMMM Do YYYY")}];return s.jsxs(v,{title:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-bold",children:"Opportunities"}),s.jsx(p,{permission:"create-quote",children:s.jsx(S,{onClick:()=>l(!0),className:"bg-primary text-white cursor-pointer rounded-sm text-[14px] p-[2px]"})})]}),bodyStyle:{padding:0},children:[s.jsx("div",{children:s.jsx(p,{permission:"readAll-opportunity",children:s.jsx(C,{columns:j,loading:m,data:e?e.opportunity:[]})})}),s.jsx(p,{permission:"create-opportunity",children:s.jsx(h,{onClose:n,open:i,title:"Create Opportunity",width:window.innerWidth<=768?"100%":"45%",placement:"right",children:s.jsx(x,{onClose:n,open:i,createAs:{name:u,value:e==null?void 0:e.id,singleLoadThunk:o}})})}),s.jsx(p,{permission:"update-opportunity",children:s.jsx(h,{onClose:r,open:!!c,title:"Update Opportunity",width:window.innerWidth<=768?"100%":"45%",placement:"right",children:s.jsx(x,{onClose:r,open:!!c,edit:c,singleLoad:{thunk:o,id:e==null?void 0:e.id}})})})]})}function E({data:e,updateThunk:m,loadThunk:u}){const o=w(),[i,l]=a.useState(),c=d=>{const n=d[0];l(n),o(m({id:e==null?void 0:e.id,values:{image:n==null?void 0:n.id}})).then(r=>{r.payload.message==="success"&&o(u(e==null?void 0:e.id))}).catch(r=>{console.log(r)}).finally(()=>{l(!1)})};return s.jsx(s.Fragment,{children:s.jsx(k,{onInsert:c,filter:{image:"image"},button:s.jsx("div",{className:"relative",children:i||e!=null&&e.image?s.jsx("img",{src:`${window.env.VITE_APP_API}/media/view/${(i==null?void 0:i.id)||(e==null?void 0:e.image)}`,alt:(i==null?void 0:i.id)||(e==null?void 0:e.image),className:"w-16 h-16 object-cover rounded"}):s.jsx("div",{className:"w-16 h-16 flex items-center justify-center rounded-full bg-slate-600 group relative",children:s.jsx(N,{size:30,className:"text-blue-500"})})})})})}export{E as I,P as O};
