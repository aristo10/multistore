import{cM as v,cL as Y,cS as j,cN as e,r as y,cO as C}from"./vendor-3a94a37a.js";import{fp as E,aX as R,ac as $,d as w,fq as O,C as A,c6 as P}from"./index-ed7845ca.js";import{R as M}from"./ReportTable-b23b8ac7.js";import{i as I}from"./invoiceGenerator-eaeb8720.js";import{u as V}from"./useCurrency-4b14dd3d.js";import{b as u,D as S}from"./vendor-large-f75deccb.js";function T({data:i,title:p,info:r,type:l,customer:n,pageConfig:o,btnName:x}){const{currencySymbol:h}=V()||{},m=v(s=>{var D;return(D=s==null?void 0:s.setting)==null?void 0:D.data})||null;Y();const d=E(h),t=[],a=[{label:"Total Quantity: ",value:`${r.totalUnitQuantity?r.totalUnitQuantity:0}`},{label:"Total Coupon: ",value:`${d}${r.totalReturnCouponAmount?r.totalReturnCouponAmount:0}`},{label:"Total Vat: ",value:`${d}${r.totalReturnVatAmount?r.totalReturnVatAmount:0}`},{label:"Total Discount: ",value:`${d}${r.totalReturnDiscountAmount?r.totalReturnDiscountAmount:0}`},{label:"Total Paid: ",value:`${d}${r.totalReturnPaidAmount?r.totalReturnPaidAmount:0}`},{label:"Total: ",value:`${d}${r.totalAmount?r.totalAmount:0}`}],c=["SL","Date","Order Id","Return Type","Note","Status","Vat","Total"],b=i.map((s,D)=>[D+1,j(s.date).format("DD-MM-YYYY"),s.cartOrderId,s.returnType,s.note,s.returnCartOrderStatus,`${d}${s.totalVatAmount?s.totalVatAmount:0}`,`${d}${s.totalAmount?s.totalAmount:0}`]),N=[{value:`Customer:${n?`${n}`:" All"}`},{value:`Return Type: ${o.returnType?o.returnType:"All"}`},{value:`Return Status: ${o.returnCartOrderStatus?o.returnCartOrderStatus:"All"}`}],f=[{value:`From: ${j(o.startDate).format("DD-MM-YYYY")}`},{value:`To: ${j(o.endDate).format("DD-MM-YYYY")}`}],g={jsPDF:{},tableFontSize:10,infoTopFontSize:10,bottomRightFontSize:12,bottomLeftFontSize:8,footerFontSize:10};return e.jsx("div",{className:"flex gap-2",children:e.jsx(R,{className:"bg-primary flex justify-center items-center px-4 py-2 text-white rounded",onClick:()=>I(l,{title:p,TopRightInfo:f,companyInfo:m,customerInfo:N,bottomLeftContent:t,bottomRightContent:a,tableBody:b,tableHead:c,settings:g}),children:x})})}function F({setPageConfig:i,pageConfig:p,setCustomer:r}){const l=Y(),{list:n,loading:o}=v(t=>t.customers),x=(t,a)=>{i(c=>({...c,[a]:t}))},h=(t,a)=>{const c=t.split(","),b=c[0].trim(),[N,f]=c[1].split(":");N.trim()==="customer"&&r(f.trim()),i(s=>({...s,[a]:b}))},m=t=>{const a=t.format("YYYY-MM-DD");i(c=>({...c,startDate:a}))},d=t=>{const a=t.format("YYYY-MM-DD");i(c=>({...c,endDate:a}))};return y.useEffect(()=>{l($({query:"all"})),l(w({query:"all"}))},[l]),e.jsxs("div",{className:"flex flex-col items-center gap-2 p-5 m-4 rounded bg-white w-2/5",children:[e.jsxs("div",{className:"w-full flex gap-3",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"text-base py-2",children:"Return Status"}),e.jsxs(u,{placeholder:"Return Status",showSearch:!1,allowClear:!0,style:{width:"100%"},maxTagPlaceholder:t=>e.jsxs("div",{className:"",children:[t.length," Selected"]}),maxTagCount:0,onChange:t=>x(t,"returnCartOrderStatus"),children:[e.jsx(u.Option,{value:"PENDING",children:"Pending"}),e.jsx(u.Option,{value:"RECEIVED",children:"Received"}),e.jsx(u.Option,{value:"RESEND",children:"Resend"}),e.jsx(u.Option,{value:"RESENDED",children:"Resended"})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"text-base py-2",children:"Customer"}),e.jsx(u,{placeholder:"Customer",loading:o,allowClear:!0,showSearch:!1,style:{width:"100%"},maxTagPlaceholder:t=>e.jsxs("div",{className:"",children:[t.length," Selected"]}),maxTagCount:0,onChange:t=>h(t,"customerId"),children:n==null?void 0:n.map(t=>e.jsx(u.Option,{value:`${t.id},customer:${t==null?void 0:t.username}`,children:t==null?void 0:t.username},t.id))})]})]}),e.jsxs("div",{className:"w-full flex gap-3",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"text-base py-2",children:"From"}),e.jsx(S,{onChange:m,defaultValue:C(p.startDate,"YYYY-MM-DD")})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"text-base py-2",children:"To"}),e.jsx(S,{onChange:d,defaultValue:C(p.endDate,"YYYY-MM-DD")})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"text-base py-2",children:"Return Type"}),e.jsxs(u,{placeholder:"Return Type",showSearch:!1,style:{width:"100%"},maxTagPlaceholder:t=>e.jsxs("div",{className:"",children:[t.length," Selected"]}),maxTagCount:0,onChange:t=>x(t,"returnType"),children:[e.jsx(u.Option,{value:"PRODUCT",children:"Product"}),e.jsx(u.Option,{value:"REFUND",children:"Refund"})]})]})]})}function Q(){const i=Y(),[p,r]=y.useState(!1),{report:l,loading:n,info:o}=v(a=>a.cartDynamic),[x,h]=y.useState(),[m,d]=y.useState({query:"report",startDate:j().startOf("month").format("YYYY-MM-DD"),endDate:j().endOf("month").format("YYYY-MM-DD")}),t=[{id:1,title:"Order Id",dataIndex:"cartOrderId",key:"cartOrderId"},{id:2,title:"Return Type",dataIndex:"returnType",key:"returnType"},{id:3,title:"Note",dataIndex:"note",key:"note"},{id:4,title:"Status",dataIndex:"returnCartOrderStatus",key:"returnCartOrderStatus",render:a=>e.jsx("span",{className:` rounded px-2 py-[1px] text-ePrimary bg-ePrimary/10 ${a=="PENDING"&&"text-orange-500 bg-orange-500/10"}
                  ${a=="RECEIVED"&&"text-ePrimary bg-ePrimary/10"}
                  ${a=="DELIVERED"&&"text-green-500 bg-green-500/10"}
                  ${a=="CANCELLED"&&"text-red-500 bg-red-500/10"}
                    `,children:a})}];return y.useEffect(()=>{i(O(m))},[i,m]),e.jsx("div",{className:"card card-custom mt-3 ",children:e.jsx("div",{className:"card-body",children:e.jsxs(A,{className:"max-md:border-0 max-md:bg-white",bodyClass:"max-md:p-0 ",headClass:"border-none",title:"Order Return Report",children:[e.jsx(F,{setPageConfig:d,pageConfig:m,setCustomer:h}),e.jsx("div",{className:"flex p-5 items-start ",children:e.jsx("div",{children:e.jsx(R,{onClick:()=>r(!0),className:"px-4 py-2 text-base rounded bg-green-500 text-white",children:"Generate Report"})})}),e.jsxs("div",{className:"flex px-5 items-center gap-2 ",children:[!n&&l?e.jsx(T,{data:l,info:o,customer:x,title:"Order Return Report",pageConfig:m,type:"print",btnName:"Print"}):e.jsx("div",{children:e.jsx(R,{loading:n||!l,className:"bg-primary text-white py-[8px] px-4 rounded",children:"Print"})}),!n&&l?e.jsx(T,{data:l,customer:x,title:"Order Return Report",info:o,pageConfig:m,type:"download",btnName:"Export PDF"}):e.jsx("div",{children:e.jsx(R,{loading:n||!l,className:"bg-primary text-white py-[8px] px-4 rounded",children:"Export PDF"})}),e.jsx("div",{children:e.jsx(P,{className:"px-4 py-2  rounded bg-primary text-white ",list:l,columns:t,title:"Return Order Report",btnName:"Export CSV",children:"Export CSV"})})]}),p&&e.jsx(M,{list:l,columns:t,loading:n})]})})})}export{Q as default};
