import{cM as r,cL as M,r as q,cN as t,cO as u}from"./vendor-3a94a37a.js";import{A as E,B,a as z,D as R,t as P,d as V,E as G,F as H,v as J}from"./index-ed7845ca.js";import{F as n,I as c,b as l,D as g,B as w}from"./vendor-large-f75deccb.js";function W({onClose:i,createAs:e,edit:a,singleLoad:s}){const{list:y,loading:O}=r(o=>o.company),{list:d,loading:C}=r(o=>o.opportunitySource),{list:h,loading:f}=r(o=>o.opportunityStage),{list:m,loading:D}=r(o=>o.opportunityType),{list:I,loading:b}=r(o=>o.users),{list:x,loading:N}=r(o=>o.contact),{loading:T}=r(o=>o.opportunity),[j]=n.useForm(),p=M();q.useEffect(()=>{p(E()),p(B()),p(z()),p(R()),p(P()),p(V({query:"all"}))},[p]);const F=async o=>{const S={...o,opportunityCreateDate:u(o.opportunityCreateDate).format("YYYY-MM-DD"),opportunityCloseDate:u(o.opportunityCloseDate).format("YYYY-MM-DD"),opportunityOwnerId:parseInt(o.opportunityOwnerId),companyId:parseInt(o.companyId),contactId:parseInt(o.contactId),opportunityTypeId:parseInt(o.opportunityTypeId),opportunityStageId:parseInt(o.opportunityStageId),opportunitySourceId:parseInt(o.opportunitySourceId)};a?(await p(G({id:a.id,values:S}))).payload.message==="success"&&(s!=null&&s.thunk&&p(s.thunk(s.id)),i()):(await p(H(S))).payload.message==="success"&&(j.resetFields(),e!=null&&e.name?p(e.singleLoadThunk(e.value)):p(J()),i())},Y=()=>{j.resetFields(),i()},k=o=>{console.log("Failed:",o)};return t.jsx("div",{className:"flex justify-center mt-5",children:t.jsxs(n,{className:"w-4/5",onFinish:F,onFinishFailed:k,colon:!1,layout:"vertical",form:j,initialValues:e?{[e.name]:e.value}:a?{opportunityName:a==null?void 0:a.opportunityName,amount:a==null?void 0:a.amount,opportunityOwnerId:a==null?void 0:a.opportunityOwnerId,contactId:a==null?void 0:a.contactId,companyId:a==null?void 0:a.companyId,opportunityTypeId:(a==null?void 0:a.opportunityTypeId)||"",opportunityStageId:(a==null?void 0:a.opportunityStageId)||"",opportunitySourceId:(a==null?void 0:a.opportunitySourceId)||"",nextStep:(a==null?void 0:a.nextStep)||"",competitors:(a==null?void 0:a.competitors)||"",description:(a==null?void 0:a.description)||"",opportunityCreateDate:u(a==null?void 0:a.opportunityCreateDate)||"",opportunityCloseDate:u(a==null?void 0:a.opportunityCloseDate)||""}:{},children:[t.jsx(n.Item,{style:{width:"100%"},label:"Name",name:"opportunityName",tooltip:"This is a required field",rules:[{required:!0,message:"Opportunity Name is Required."}],children:t.jsx(c,{placeholder:"Test"})}),t.jsx(n.Item,{label:"Opportunity owner",name:"opportunityOwnerId",children:t.jsx(l,{style:{width:"100%"},loading:b,allowClear:!0,showSearch:!0,placeholder:"Select Opportunity owner name",children:I==null?void 0:I.map(o=>t.jsx(l.Option,{value:o.id,children:o==null?void 0:o.username},o.id))})}),t.jsx(n.Item,{label:"Amount",name:"amount",children:t.jsx(c,{placeholder:"10000"})}),t.jsx(n.Item,{label:"Next step",name:"nextStep",children:t.jsx(c,{placeholder:"Next"})}),t.jsx(n.Item,{label:"Opportunity create date",name:"opportunityCreateDate",children:t.jsx(g,{placeholder:"Select opportunity create date"})}),t.jsx(n.Item,{label:"Opportunity Close Date",name:"opportunityCloseDate",children:t.jsx(g,{placeholder:"Select opportunity create date"})}),t.jsx(n.Item,{label:"Company",name:"companyId",children:t.jsx(l,{style:{width:"100%"},loading:O,allowClear:!0,showSearch:!0,placeholder:"Select company Name",disabled:(e==null?void 0:e.name)==="companyId",children:y==null?void 0:y.map(o=>t.jsx(l.Option,{value:o.id,children:o.companyName},o.id))})}),t.jsx(n.Item,{label:"Contact",name:"contactId",children:t.jsx(l,{style:{width:"100%"},loading:N,allowClear:!0,showSearch:!0,placeholder:"Select Contact",disabled:(e==null?void 0:e.name)==="contactId",children:x==null?void 0:x.map(o=>t.jsxs(l.Option,{value:o.id,children:[o==null?void 0:o.firstName," ",o==null?void 0:o.lastName]},o.id))})}),t.jsx(n.Item,{label:"Competitors",name:"competitors",children:t.jsx(c,{placeholder:"Text"})}),t.jsx(n.Item,{label:"Opportunity type",name:"opportunityTypeId",children:t.jsx(l,{style:{width:"100%"},loading:D,allowClear:!0,showSearch:!0,placeholder:"Select opportunity type",children:m==null?void 0:m.map(o=>t.jsx(l.Option,{value:o.id,children:o.opportunityTypeName},o.id))})}),t.jsx(n.Item,{label:"Opportunity source",name:"opportunitySourceId",children:t.jsx(l,{style:{width:"100%"},loading:C,allowClear:!0,showSearch:!0,placeholder:"Select contact Source",children:d==null?void 0:d.map(o=>t.jsx(l.Option,{value:o.id,children:o.opportunitySourceName},o.id))})}),t.jsx(n.Item,{label:"Opportunity stage",name:"opportunityStageId",children:t.jsx(l,{style:{width:"100%"},loading:f,allowClear:!0,showSearch:!0,placeholder:"Select contact stage",children:h==null?void 0:h.map(o=>t.jsx(l.Option,{value:o.id,children:o.opportunityStageName},o.id))})}),t.jsx(n.Item,{label:"Description",name:"description",children:t.jsx(c.TextArea,{placeholder:"Describe about contact"})}),t.jsx(n.Item,{label:"",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(w,{size:"large",htmlType:"submit",type:"primary",loading:T,children:"Create"}),t.jsx(w,{size:"large",type:"danger",onClick:Y,children:"Cancel"})]})})]})})}export{W as A};
