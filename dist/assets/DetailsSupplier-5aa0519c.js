import{cN as e,cQ as u,cS as v,dl as w,cM as N,cL as S,r as d,da as B,cU as L,cT as z,dt as V,dc as K}from"./vendor-3a94a37a.js";import{am as k,s as M,aZ as G,aX as I,h2 as H,h3 as O,C as g,bt as Q,L as X}from"./index-ed7845ca.js";import{L as T}from"./List-9eb27318.js";import{T as _,a as A}from"./Tabs-8f68912a.js";import{V as q}from"./ViewBtn-ffc9b5cb.js";import"./UploadMany-c4472299.js";import{s as U}from"./emailConfigSlice-145edc06.js";import{T as $}from"./TagInput-f33dd18b.js";import{textEditorModule as W,textEditorFormats as Z}from"./AddProduct-aa890cea.js";import{F as x,I as P,a as C,c as J,B as Y,n as ee,k as te}from"./vendor-large-f75deccb.js";import{i as se}from"./invoiceGenerator-eaeb8720.js";import{u as le}from"./useCurrency-4b14dd3d.js";import"./ImageUploader-c0ae741f.js";import"./MediaGallery-5095f29f.js";import"./UploaderWithDrag-568744bd.js";import"./BigDrawer-240149a9.js";import"./AddManufacturer-2f6bafee.js";import"./AddProductBrand-894ab785.js";import"./AddProductSubcategory-71762def.js";import"./AddProductCategory-6511f02f.js";import"./AddUoM-1dc09ff9.js";import"./AddVatTax-97a0925d.js";import"./FormProductListCard-571d2cbc.js";import"./AddProductAttribute-4ec2c5fe.js";import"./AddProductAttributeValue-d16feddc.js";import"./AddDiscount-05e89f9a.js";function oe({list:l,linkTo:o}){const n=[{title:"Invoice ",dataIndex:"id",key:"id",render:s=>e.jsx(u,{to:`${o}/${s}`,children:s})},{title:"Date",dataIndex:"date",key:"date",render:s=>v(s).format("ll")},{title:"Total Amount",dataIndex:"totalAmount",key:"total_amount"},{title:"Total Tax",dataIndex:"totalTax",key:"totalTax"},{title:"Paid",dataIndex:"paidAmount",key:"paid_amount",responsive:["md"]},{title:"Due",dataIndex:"dueAmount",key:"dueAmount",responsive:["md"]},{title:"",dataIndex:"",key:"action",render:({id:s,dueAmount:r})=>[{label:e.jsx(q,{title:"View",path:`${o}/${s}`}),key:"view"},{label:e.jsx(u,{to:r?`/admin/payment/supplier/${s}`:"#",state:{dueAmount:r},children:e.jsxs("button",{className:"flex items-center gap-2 rounded disabled:cursor-not-allowed",disabled:!r,children:[e.jsx(w,{className:"text-[1rem]"})," Payment"]})}),key:"payment"}]}],t=s=>s.map(r=>({...r,key:r.id}));return e.jsx("div",{className:"m-2",children:e.jsx(k,{scroll:{x:!0},loading:!l,columns:n,data:l?t(l):[]})})}const ne=({list:l})=>{const o=[{title:"ID",dataIndex:"id",key:"id"},{title:"Date",dataIndex:"date",key:"date",render:t=>v(t).format("ll")},{title:"Total Amount",key:"totalAmount",render:({totalAmount:t,tax:s})=>`${t+(s||0)}`},{title:"Note",dataIndex:"note",key:"note"},{title:"Purchase Invoice No",dataIndex:"purchaseInvoiceId",key:"purchaseInvoiceId",render:t=>e.jsx(u,{to:`/admin/purchase/${t}`,children:t})}],n=t=>t.map(s=>({...s,key:s.id}));return e.jsx("div",{className:"m-2",children:e.jsx(k,{scroll:{x:!0},columns:o,data:l?n(l):[]})})},re=({list:l})=>{const o=[{title:"ID",dataIndex:"id",key:"id",render:t=>e.jsx(u,{to:`/admin/transaction/${t}`,children:t})},{title:"Date",dataIndex:"date",key:"date",render:t=>v(t).format("ll")},{title:"Debit",dataIndex:"debit",key:"debit",render:t=>e.jsx(u,{to:`/admin/account/${t==null?void 0:t.id}`,children:t==null?void 0:t.name})},{title:"Credit",dataIndex:"credit",key:"credit",render:t=>e.jsx(u,{to:`/admin/account/${t==null?void 0:t.id}`,children:t==null?void 0:t.name})},{title:"Amount",dataIndex:"amount",key:"amount"},{title:"Type ",dataIndex:"type",key:"type"},{title:"Particulars",dataIndex:"particulars",key:"particulars",render:t=>e.jsx("div",{title:t,children:M(t,20)})}],n=t=>t.map(s=>({...s,key:s.id}));return e.jsx("div",{className:"m-2",children:e.jsx(k,{scroll:{x:!0},columns:o,data:l?n(l):[]})})};function ae({setSendEmail:l,data:o}){const n=N(i=>{var c;return(c=i==null?void 0:i.setting)==null?void 0:c.data})||null,t=`Supplier Ledger - ${n==null?void 0:n.companyName}`,s=`
    <div>
      <p>Dear <strong>${o==null?void 0:o.name}</strong>,</p>
      <p>Greetings! We trust this message reaches you in great spirits.</p>
    </div>
    <br>
    <p>Here is the summary of your accounts:</p>
    <br>
    <div>
      Total Amount: ${o==null?void 0:o.totalAmount}<br>
      Paid Amount: ${o==null?void 0:o.totalPaidAmount}<br>
      Return Amount: ${o==null?void 0:o.totalReturnAmount}<br>
      Due Amount: ${o==null?void 0:o.dueAmount}
    </div>
    <br>
    <div>
      Total invoice count: ${o==null?void 0:o.totalPurchaseInvoice}<br>
      Total return invoice count: ${o==null?void 0:o.totalReturnPurchaseInvoice}
    </div>
    <br>
    <div >
      Best Regards,<br>
      <strong>${n==null?void 0:n.companyName}</strong><br>
      ${n==null?void 0:n.phone}<br>
      ${n==null?void 0:n.email}
    </div>
  `,[r]=x.useForm(),f=S(),[y,h]=d.useState(!1),[b,j]=d.useState([]),[p,a]=d.useState([]),[m,F]=d.useState(s),D=async i=>{h(!0);try{let c=new FormData;i.receiverEmail&&c.append("receiverEmail",i.receiverEmail),i.subject&&c.append("subject",i.subject),m&&c.append("body",m),b.length>0&&c.append("cc[]",b),p.length>0&&c.append("bcc[]",p),(await f(U(c))).payload.message==="success"&&(l(!1),h(!1),r.resetFields(),j([]),a([]))}catch(c){console.log(c)}h(!1)},R=()=>{},E=i=>{F(i)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"py-4 px-4 border-t",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:""}),e.jsx("button",{onClick:()=>l(!1),className:"bg-red-100 p-1 rounded text-red-500",children:e.jsx(B,{size:20})})]}),e.jsxs(x,{onFinish:D,onFinishFailed:R,colon:!1,layout:"vertical",form:r,initialValues:{subject:t,body:s,receiverEmail:o.email||""},children:[e.jsx(x.Item,{style:{width:"100%"},label:"To",rules:[{required:!0,message:"Please input receiver email!"}],name:"receiverEmail",children:e.jsx(P,{placeholder:"Receiver Email"})}),e.jsx(C,{bordered:!1,defaultActiveKey:["0"],expandIcon:({isActive:i})=>e.jsx(J,{rotate:i?90:0}),className:"site-collapse-custom-collapse mb-4 ",children:e.jsxs(C.Panel,{header:"CC & BCC",children:[e.jsx($,{label:"CC",tags:b,setTags:j}),e.jsx($,{label:"BCC",tags:p,setTags:a})]},"1")}),e.jsx(x.Item,{style:{width:"100%"},label:"Subject",name:"subject",children:e.jsx(P,{placeholder:"Subject"})}),e.jsx(x.Item,{style:{marginBottom:"25px"},label:"Body",children:e.jsx(L,{value:m,onChange:E,modules:W,formats:Z})}),e.jsx(x.Item,{children:e.jsx(Y,{loading:y,size:"large",htmlType:"submit",type:"primary",children:"Send"})})]})]})})}function ie({data:l,title:o}){var p;le();const n=N(a=>{var m;return(m=a==null?void 0:a.setting)==null?void 0:m.data})||null,t=S(),s=[],r=[{label:"Total Amount",value:` ${l.totalAmount.toFixed(2)}`},{label:"Paid Amount",value:` ${l.totalPaidAmount.toFixed(2)}`},{label:"Return Amount",value:`${l.totalReturnAmount.toFixed(2)}`},{label:"Due Amount",value:`${l.dueAmount.toFixed(2)}`}],f=["SL","Invoice","Date","Amount","Tax","Paid","Due"],y=(p=l==null?void 0:l.purchaseInvoice)==null?void 0:p.map((a,m)=>[m+1,a.id,v(a.date).format("ll"),a.totalAmount,a.totalTax,a.paidAmount,a.dueAmount]),h=[{value:`Supplier: ${l!=null&&l.name?l.name:"N/A"}`},{value:`Phone: ${l!=null&&l.phone?l.phone:"N/A"}`},{value:`Email: ${l!=null&&l.email?l.email:"N/A"}`}],b=[{value:`Address: ${l!=null&&l.address?l.address:"N/A"}`}],j={jsPDF:{},tableFontSize:10,infoTopFontSize:10,bottomRightFontSize:10,bottomLeftFontSize:8,footerFontSize:10};return d.useEffect(()=>{!n&&t(G())},[t,n]),e.jsx("div",{className:"",children:e.jsx(I,{color:"primary",onClick:()=>se("print",{title:o,TopRightInfo:b,customerInfo:h,companyInfo:n,bottomLeftContent:s,bottomRightContent:r,tableBody:y,tableHead:f,settings:j,leftBottomSecondColumnX:55}),children:"Print"})})}const Be=()=>{const{id:l}=z(),[o,n]=d.useState(!1),t=S(),s=N(r=>r.suppliers.supplier);return d.useEffect(()=>(t(H(l)),()=>{t(O())}),[t,l]),e.jsx("div",{children:e.jsx("div",{className:"",children:s?e.jsx(d.Fragment,{children:e.jsxs("div",{className:"flex gap-2 md:gap-4",children:[e.jsxs(g,{className:"w-2/3",bodyClass:"p-0",children:[e.jsx("div",{className:"flex justify-between mx-2 py-2 border-b items-center",children:e.jsxs("div",{className:" flex gap-3",children:[e.jsx("div",{children:e.jsx(ie,{data:s,title:"Supplier Invoice List"})}),e.jsx(I,{className:"flex-row-reverse",color:"gray",icon:e.jsx(V,{size:15}),onClick:()=>{n(!0)},children:"Send"}),e.jsx(ee,{content:e.jsx(Q,{items:[{key:"status",label:e.jsxs(u,{className:"flex items-center gap-2",to:`/admin/supplier/${s.id}/update`,state:{data:s},children:[e.jsx(te,{})," Edit"]})}]}),placement:"bottomRight",arrow:!1,trigger:"click",children:e.jsx(I,{color:"gray",icon:e.jsx(K,{size:15}),className:"  px-3"})})]})}),o?e.jsx(ae,{setSendEmail:n,data:s}):e.jsxs(_,{className:"mt-4",children:[e.jsx(A,{label:e.jsxs("span",{children:["Invoice"," ",e.jsx("span",{className:"ml-2 rounded-full bg-slate-300 text-slate-700 px-1",children:s.totalPurchaseInvoice})]}),children:e.jsx(oe,{list:s.purchaseInvoice,linkTo:"/admin/purchase"})}),e.jsx(A,{label:e.jsxs("span",{children:["Return Invoice"," ",e.jsx("span",{className:"ml-2 rounded-full bg-slate-300 text-slate-700 px-1",children:s.totalReturnPurchaseInvoice})]}),children:e.jsx(ne,{list:s.returnPurchaseInvoice})}),e.jsx(A,{label:"Transactions",children:e.jsx(re,{list:s.allTransaction})})]})]}),e.jsxs("div",{className:"w-1/3 flex flex-col gap-2 md:gap-4",children:[e.jsx(g,{title:"Supplier",children:e.jsx(T,{labelClassName:"w-[30%]",list:[{label:"Name",value:s.name},{label:"Email",value:s.email||"N/A"},{label:"Phone",value:s.phone},{label:"Address",value:s.address}]})}),e.jsx(g,{children:e.jsx(T,{labelClassName:"w-[30%]",list:[{label:"Total Amount",value:s.totalAmount},{label:"Paid Amount",value:e.jsx("div",{className:"before:content-['-'] relative before:absolute before:text-red-500 before:font-bold before:-left-3 before:top-0",children:s.totalPaidAmount})},{label:"Return Amount",value:e.jsx("div",{className:"before:content-['-'] relative before:absolute before:text-red-500 before:font-bold before:-left-3 before:top-0",children:s.totalReturnAmount}),className:"border-b pb-1"},{label:"Due Amount",value:s.dueAmount}]})})]})]})},s.id):e.jsx(X,{})})})};export{Be as default};
