import{cM as u,cL as O,r as N,cN as e,dn as L,dp as R,cQ as b,cS as Q}from"./vendor-3a94a37a.js";import{t as T,a as F,v as D,w as U,d as E,U as v,fc as $,dd as z,fd as V,C as B}from"./index-ed7845ca.js";import{F as t,I as q,b as i,B as S}from"./vendor-large-f75deccb.js";function K({createAs:l}){const{list:x,loading:w}=u(a=>a.company),{list:c,loading:j}=u(a=>a.contact),{list:d,loading:y}=u(a=>a.opportunity),{list:o,loading:f}=u(a=>a.quote),{list:r,loading:I}=u(a=>a.users),[p]=t.useForm(),n=O(),[g,h]=N.useState(!1);N.useEffect(()=>{n(T()),n(F()),n(D()),n(U()),n(E({query:"all"}))},[n]);const m=async a=>{h(!0);const C={...a,noteOwnerId:parseInt(a.noteOwnerId),companyId:parseInt(a.companyId),opportunityId:parseInt(a.opportunityId),contactId:parseInt(a.contactId),quoteId:parseInt(a.quoteId)};(await n($(C))).payload.message==="success"&&(p.resetFields(),n(l?l.singleLoadThunk(l.id):z({})),h(!1))};return e.jsx("div",{className:"flex justify-center mt-5",children:e.jsx(v,{permission:"create-note",children:e.jsxs(t,{className:"w-4/5",onFinish:m,layout:"vertical",form:p,initialValues:l==null?void 0:l.values,children:[e.jsx(t.Item,{style:{width:"100%"},label:"Title",name:"title",tooltip:"This is a required field",rules:[{required:!0,message:"Title is Required."}],children:e.jsx(q,{placeholder:"Note title"})}),e.jsx(t.Item,{label:"Note owner",name:"noteOwnerId",tooltip:"This is a required field",rules:[{required:!0,message:"Owner is Required."}],children:e.jsx(i,{style:{width:"100%"},loading:I,allowClear:!0,showSearch:!0,placeholder:"Select note owner name",children:r==null?void 0:r.map(a=>e.jsx(i.Option,{value:a.id,children:a==null?void 0:a.username},a.id))})}),e.jsx(t.Item,{label:"Company",name:"companyId",children:e.jsx(i,{style:{width:"100%"},loading:w,allowClear:!0,showSearch:!0,placeholder:"Select company Name",disabled:(l==null?void 0:l.name)==="companyId",children:x==null?void 0:x.map(a=>e.jsx(i.Option,{value:a.id,children:a.companyName},a.id))})}),e.jsx(t.Item,{label:"Contact",name:"contactId",children:e.jsx(i,{style:{width:"100%"},loading:j,allowClear:!0,showSearch:!0,placeholder:"Select contact",disabled:(l==null?void 0:l.name)==="contactId",children:c==null?void 0:c.map(a=>e.jsx(i.Option,{value:a.id,children:a.fullName?a.fullName:a.firstName+" "+a.lastName},a.id))})}),e.jsx(t.Item,{label:"Opportunity",name:"opportunityId",children:e.jsx(i,{style:{width:"100%"},loading:y,allowClear:!0,showSearch:!0,placeholder:"Select opportunity",disabled:(l==null?void 0:l.name)==="opportunityId",children:d==null?void 0:d.map(a=>e.jsx(i.Option,{value:a.id,children:a.opportunityName},a.id))})}),e.jsx(t.Item,{label:"Quote",name:"quoteId",children:e.jsx(i,{style:{width:"100%"},loading:f,allowClear:!0,showSearch:!0,placeholder:"Select quote",disabled:(l==null?void 0:l.name)==="quoteId",children:o==null?void 0:o.map(a=>e.jsx(i.Option,{value:a.id,children:a.quoteName},a.id))})}),e.jsx(t.Item,{label:"Description",name:"description",children:e.jsx(q.TextArea,{placeholder:"Describe about contact"})}),e.jsx(t.Item,{label:"",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(S,{loading:g,size:"large",htmlType:"submit",type:"primary",children:"Create"})})})]})})})}function P({onCancel:l,onClose:x,id:w,note:c,load:j}){const{list:d,loading:y}=u(s=>s.company),{list:o,loading:f}=u(s=>s.contact),{list:r,loading:I}=u(s=>s.opportunity),{list:p,loading:n}=u(s=>s.users),[g,h]=N.useState(!1),[m]=t.useForm(),a=O();N.useEffect(()=>{a(T()),a(F()),a(D()),a(E({query:"all"}))},[a]);const C=async s=>{h(!0);const k={...s,noteOwnerId:parseInt(s.noteOwnerId),companyId:parseInt(s.companyId),opportunityId:parseInt(s.opportunityId),contactId:parseInt(s.contactId),quoteId:parseInt(s.quoteId)};(await a(V({id:w,values:k}))).payload.message==="success"&&(m.resetFields(),j&&j(),x()),h(!1)};return N.useEffect(()=>{m.setFieldsValue(c)},[m,c]),e.jsx("div",{className:"flex justify-center mt-5",children:e.jsx(v,{permission:"update-note",children:e.jsxs(t,{className:"w-4/5",onFinish:C,colon:!1,layout:"vertical",form:m,children:[e.jsx(t.Item,{style:{width:"100%"},label:"Title",name:"title",tooltip:"This is a required field",rules:[{required:!0,message:"Title is Required."}],children:e.jsx(q,{placeholder:"Note title"})}),e.jsx(t.Item,{label:"Note owner",name:"noteOwnerId",tooltip:"This is a required field",rules:[{required:!0,message:"Owner is Required."}],children:e.jsx(i,{style:{width:"100%"},loading:n,allowClear:!0,showSearch:!0,placeholder:"Select note owner name",children:p==null?void 0:p.map(s=>e.jsxs(i.Option,{value:s.id,children:[s==null?void 0:s.firstName," ",s==null?void 0:s.lastName]},s.id))})}),e.jsx(t.Item,{label:"Company",name:"companyId",children:e.jsx(i,{style:{width:"100%"},loading:y,allowClear:!0,showSearch:!0,placeholder:"Select company Name",children:d==null?void 0:d.map(s=>e.jsx(i.Option,{value:s.id,children:s.companyName},s.id))})}),e.jsx(t.Item,{label:"Contact",name:"contactId",children:e.jsx(i,{style:{width:"100%"},loading:f,allowClear:!0,showSearch:!0,placeholder:"Select contact",children:o==null?void 0:o.map(s=>e.jsxs(i.Option,{value:s.id,children:[s.firstName," ",s.lastName]},s.id))})}),e.jsx(t.Item,{label:"Opportunity",name:"opportunityId",children:e.jsx(i,{style:{width:"100%"},loading:I,allowClear:!0,showSearch:!0,placeholder:"Select opportunity",children:r==null?void 0:r.map(s=>e.jsx(i.Option,{value:s.id,children:s.opportunityName},s.id))})}),e.jsx(t.Item,{label:"Description",name:"description",children:e.jsx(q.TextArea,{placeholder:"Describe about contact"})}),e.jsx(t.Item,{label:"",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{loading:g,size:"large",htmlType:"submit",type:"primary",children:"Update"}),e.jsx(S,{size:"large",htmlType:"submit",type:"danger",onClick:l,children:"Cancel"})]})})]})})})}function W({note:l,onClose:x,load:w}){var y,o,f,r,I,p,n,g,h;const[c,j]=N.useState(),d=()=>{j(m=>!m)};return e.jsx(e.Fragment,{children:e.jsx(v,{permission:"readSingle-note",children:e.jsx(B,{title:"Note Details",extra:c?e.jsxs("div",{onClick:d,className:"select-none py-2 px-3 border bg-teal-700 hover:bg-teal-500 text-white rounded cursor-pointer  flex items-center justify-center gap-2",children:[e.jsx(L,{}),"View Note"]}):e.jsxs("div",{onClick:d,className:"select-none py-2 px-3 border bg-teal-700 hover:bg-teal-500 text-white rounded cursor-pointer  flex items-center justify-center gap-2",children:[e.jsx(R,{}),"Edit Note"]}),children:c?e.jsx(P,{onCancel:d,onClose:x,id:l==null?void 0:l.id,note:l,load:w}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-evenly items-center gap-10 border-b py-2",children:[(l==null?void 0:l.contact)&&e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("span",{className:"font-bold",children:"Contact"}),e.jsxs(b,{to:`/admin/crm/contact/${(y=l.contact)==null?void 0:y.id}`,children:[(o=l.contact)==null?void 0:o.firstName," ",(f=l.contact)==null?void 0:f.lastName]})]}),(l==null?void 0:l.company)&&e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("span",{className:"font-bold",children:"Company"}),e.jsx(b,{to:`/admin/crm/company/${(r=l.company)==null?void 0:r.id}`,children:(I=l.company)==null?void 0:I.companyName})]}),(l==null?void 0:l.opportunity)&&e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("span",{className:"font-bold",children:"Opportunity"}),e.jsx(b,{to:`/admin/crm/opportunity/${(p=l.opportunity)==null?void 0:p.id}`,children:(n=l.opportunity)==null?void 0:n.opportunityName})]}),(l==null?void 0:l.quote)&&e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("span",{className:"font-bold",children:"Quote"}),e.jsx(b,{to:`/admin/crm/quote/${(g=l.quote)==null?void 0:g.id}`,children:(h=l.quote)==null?void 0:h.quoteName})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"p-5",children:[e.jsx("p",{className:"text-xl font-bold",children:l==null?void 0:l.title}),l&&e.jsx("small",{children:Q(l.createdAt).fromNow()})]}),e.jsx("p",{className:"px-5",children:l==null?void 0:l.description})]})]})})})})}export{K as A,W as D};
