import{cL as y,cN as e,r as d,cM as C,cU as O,cS as b}from"./vendor-3a94a37a.js";import{fv as M,aL as g,aj as U,C as E,U as w,T,s as Y,fw as q}from"./index-ed7845ca.js";import{C as B}from"./CommonDelete-4339174a.js";import{C as _}from"./CreateDrawer-a7af16b9.js";import{J as H,m as V,K as R,F as r,k as $,M as z,I as A,b as v,U as G,P as J,B as K}from"./vendor-large-f75deccb.js";import{A as Q}from"./AddPaymentMethod-df418ab3.js";import"./AddAccount-8cfc0f4b.js";import"./BigDrawer-240149a9.js";function W({isActive:o,id:c}){const l=y(),u=async(n,m)=>{let i=new FormData;i.append("isActive",n),i.append("_method","PUT"),(await l(M({values:i,id:m}))).payload.message==="success"&&l(g({status:"true",page:1,count:10}))};return e.jsx(H,{options:[{label:e.jsxs("span",{children:[e.jsx(V,{})," Active"]}),value:"true"},{label:e.jsxs("span",{children:[e.jsx(R,{})," Inactive"]}),value:"false"}],value:o,onChange:n=>u(n,c)})}function X({data:o}){const[c,l]=d.useState(!1),[u]=r.useForm(),n=y(),[m,i]=d.useState(!1),[p,f]=d.useState(""),[t,h]=d.useState([]),{list:x,loading:I}=C(a=>a.accounts),P=async a=>{try{let s=new FormData;o.id!==1&&(s.append("methodName",a.methodName),s.append("subAccountId",a.subAccountId),s.append("ownerAccount",a.ownerAccount),s.append("instruction",p)),s.append("_method","PUT"),s.append("images[]",t[0].originFileObj),(await n(M({values:s,id:o.id}))).payload.message==="success"&&(h([]),n(g({status:"true",page:1,count:10})),i(!1),j())}catch{i(!1)}},k=()=>{},S=()=>{l(!0)},j=()=>{l(!1)},N=({fileList:a})=>{h(a)};d.useEffect(()=>{x||n(U())},[n,x]);const F=a=>{f(a)},L=["header","font","size","bold","italic","underline","strike","blockquote","list","bullet","indent","link","image","color","background"],D={toolbar:[[{header:"1"},{header:"2"},{font:[]}],[{list:"ordered"},{list:"bullet"}],["bold","italic","underline"],["link","image"],[{color:[]},{background:[]}],["clean"]]};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>{S()},children:[e.jsx($,{className:"bg-gray-600 p-1 text-white rounded-md"}),"Edit"]}),e.jsx(z,{title:"Update Payment Method",open:c,onCancel:j,footer:!1,children:e.jsx("div",{children:e.jsxs(r,{form:u,name:"basic",layout:"vertical",className:"sm:mx-10",onFinish:P,onFinishFailed:k,autoComplete:"off",initialValues:{...o},children:[o.id!==1&&e.jsxs(e.Fragment,{children:[" ",e.jsx(r.Item,{style:{marginBottom:"15px"},label:"Method Name",name:"methodName",rules:[{required:!0,message:"Please input method name!"}],children:e.jsx(A,{})}),e.jsx(r.Item,{style:{marginBottom:"15px"},label:"Owner Account",name:"ownerAccount",className:"w-full",rules:[{required:!0,message:"Please input owner account!"}],children:e.jsx(A,{})})," ",e.jsx(r.Item,{style:{marginBottom:"15px"},label:"Sub Account",name:"subAccountId",className:"w-full",rules:[{required:!0,message:"Please input sub account!"}],children:e.jsx(v,{name:"subAccountId",loading:I,showSearch:!0,placeholder:"Select Sub Account",optionFilterProp:"children",filterOption:(a,s)=>s.children.includes(a),filterSort:(a,s)=>a.children.toLowerCase().localeCompare(s.children.toLowerCase()),children:x&&x.map(a=>e.jsx(v.Option,{value:a.id,children:a.name},a.id))})})]}),e.jsx(r.Item,{label:"Upload Logo ",valuePropName:"Logo",required:!0,children:e.jsx(G,{listType:"picture-card",beforeUpload:()=>!1,name:"image",fileList:t,maxCount:1,onChange:N,accept:"image/png, image/jpg, image/jpeg",children:e.jsxs("div",{children:[e.jsx(J,{}),e.jsx("div",{style:{marginTop:8},children:"Upload"})]})})}),o.id!==1&&e.jsx(r.Item,{style:{marginBottom:"15px"},label:"Instruction",name:"instruction",rules:[{required:!0,message:"Please input instruction !"}],children:e.jsx(O,{value:p,onChange:F,modules:D,formats:L})}),e.jsx(r.Item,{style:{marginBottom:"15px"},className:"flex justify-center mt-[24px]",children:e.jsx(K,{type:"primary",htmlType:"submit",shape:"round",loading:m,onClick:()=>{i(!0)},children:"Update payment Method"})})]})})})]})}function le(){const o=y(),{list:c,total:l,loading:u}=C(t=>t.paymentMethod),[n,m]=d.useState({page:1,count:10,status:"true"}),i=t=>{t.target.src="/images/default.jpg"},p=[{id:1,title:"ID",dataIndex:"id",key:"id",width:"50px"},{id:2,title:"Logo",dataIndex:"logo",render:t=>e.jsx("div",{className:"w-[2.5rem] h-[2.5rem] relative p-1",children:e.jsx("img",{className:"absolute object-cover w-full h-full",alt:"product",onError:i,src:`${window.env.VITE_APP_API}/files/${t}`||"/images/default.jpg"})}),csvOff:!0,key:"image",width:"100px"},{id:3,title:"Sub Account",dataIndex:"subAccount",key:"subAccount",render:t=>t.name,renderCsv:t=>t.name},{id:4,title:"Payment Method",dataIndex:"methodName",key:"methodName"},{id:5,title:"Owner Account",dataIndex:"ownerAccount",key:"ownerAccount"},{id:6,title:"Instruction",dataIndex:"instruction",key:"instruction",render:t=>e.jsx("span",{dangerouslySetInnerHTML:{__html:Y(t,20)}}),renderCsv:t=>t},{id:7,title:"Created At",dataIndex:"createdAt",key:"createdAt",render:t=>b(t).format("YYYY-MM-DD"),renderCsv:t=>b(t).format("DD/MM/YYYY")},{id:8,title:"Active",key:"isActive",render:({isActive:t,id:h})=>e.jsx(W,{isActive:t,id:h}),csvOff:!0,width:"200px"},{id:4,title:"",key:"action",render:t=>[{label:e.jsx(w,{permission:"update-paymentMethod",children:e.jsx(X,{data:t})}),key:"edit"},{label:e.jsx(B,{permission:"delete-paymentMethod",deleteThunk:q,id:t.id,title:"Hide",loadThunk:g,query:{status:!0,page:1,count:10}}),key:"delete"}]}],f=[{key:"status",label:"Status",type:"select",options:[{label:"Show",value:"true"},{label:"Hide",value:"false"}],className:"min-w-[85px] max-w-[150px]",popupClassName:"w-[200px]"}];return d.useEffect(()=>{o(g(n))},[o,n]),e.jsx(E,{className:"max-md:border-0 max-md:bg-white",bodyClass:"max-md:p-0 ",headClass:"border-none",title:"Payment Methods",extra:e.jsx(_,{permission:"create-paymentMethod",title:"Create Payment Method",width:35,children:e.jsx(Q,{})}),children:e.jsx(w,{permission:"readAll-paymentMethod",children:e.jsx(T,{total:l,columns:p,list:c,loading:u,setPageConfig:m,title:"Payment Method List",isSearch:!0,filters:f})})})}export{le as default};
