import{r as o,cL as Y,cM as b,cN as t,cO as d}from"./vendor-3a94a37a.js";import{d as v,d$ as M,e0 as A,C as k,U as E,T as w}from"./index-ed7845ca.js";import{C as B}from"./CreateDrawer-a7af16b9.js";import{F as l,b as C,D,y as I,I as T,B as S,f as U,d as i}from"./vendor-large-f75deccb.js";function P(){const[p,u]=o.useState(!1),m=Y(),{Title:f}=U,[c]=l.useForm(),{list:x,loading:j}=b(a=>a.users),[e,r]=o.useState({time:null,date:null}),[n,h]=o.useState({time:null,date:null}),y=new Date(e.date+"T"+e.time+"Z"),N=new Date(n.date+"T"+n.time+"Z"),O=async a=>{u(!0);try{const s={ip:a.ip,userId:a.userId,comment:a.comment,inTime:y!=="Invalid Date"?d(y).toISOString():null,outTime:N!=="Invalid Date"?d(N).toISOString():null};(await m(M(s))).payload.message=="success"&&(c.resetFields(),r(""),h(""),m(A({page:1,count:10,status:"true"})))}catch{}finally{u(!1)}};o.useEffect(()=>{m(v({query:"all"}))},[m]);const g=a=>a&&a>d().endOf("day");return t.jsxs(t.Fragment,{children:[t.jsx(f,{level:4,className:"m-2 mt-5 mb-5 text-center",children:"Add Manual Attendance"}),e.time===null||e.date===null||n.time===null||n.date===null?t.jsxs("p",{className:"text-center text-rose-500 text-sm font-medium mb-4",children:[" ","* Please fill Date and Time"]}):"",t.jsx(l,{form:c,style:{marginBottom:"40px"},eventKey:"shift-form",name:"basic",layout:"vertical",onFinish:O,autoComplete:"off",className:"mx-4",children:t.jsxs("div",{children:[t.jsx(l.Item,{style:{marginBottom:"10px"},label:"User",name:"userId",rules:[{required:!0,message:"Please input your user!"}],children:t.jsx(C,{placeholder:"Select User",children:x==null?void 0:x.map(a=>t.jsx(C.Option,{value:a.id,children:a.username},a.id))})}),t.jsx(l.Item,{style:{marginBottom:"10px"},label:"Start Time",name:"inTime",children:t.jsxs("div",{className:"flex justify-between",children:[t.jsx(D,{format:"YYYY-MM-DD",onChange:(a,s)=>r({...e,date:s}),disabledDate:g}),t.jsx(I,{className:"ml-4",format:"HH:mm:ss",onChange:(a,s)=>r({...e,time:s})})]})}),t.jsx(l.Item,{style:{marginBottom:"10px"},label:"End Time",name:"outTime",children:t.jsxs("div",{className:"flex justify-between",children:[t.jsx(D,{format:"YYYY-MM-DD",onChange:(a,s)=>h({...n,date:s}),disabledDate:g}),t.jsx(I,{className:"ml-4",format:"HH:mm:ss",onChange:(a,s)=>h({...n,time:s})})]})}),t.jsx(l.Item,{style:{marginBottom:"10px"},label:"Comment",name:"comment",children:t.jsx(T,{placeholder:"Comment"})}),t.jsx(l.Item,{style:{marginBottom:"10px"},label:"IP Address",name:"ip",children:t.jsx(T,{placeholder:"127.0.0.1"})}),t.jsx(l.Item,{style:{marginBottom:"10px"},className:"flex justify-center mt-6",children:t.jsx(S,{type:"primary",size:"large",htmlType:"submit",loading:p,disabled:e.time===null||e.date===null||n.time===null||n.date===null,children:"Add Attendance"})})]})})]})}function Z(){const p=Y(),{list:u,loading:m,total:f}=b(e=>e.attendance),[c,x]=o.useState({page:1,count:10,status:"true"}),j=[{id:1,title:"ID",dataIndex:"id",key:"id"},{id:10,title:"Name",dataIndex:"user",key:"user",render:e=>`${e==null?void 0:e.firstName} ${e==null?void 0:e.lastName}`,renderCsv:e=>`${e==null?void 0:e.firstName} ${e==null?void 0:e.lastName}`},{id:2,title:"In Time",dataIndex:"inTime",key:"inTime",render:e=>d(e).format("DD-MM-YYYY, h:mm A")||"NONE",renderCsv:e=>d(e).format("DD-MM-YYYY, h:mm A")||"NONE"},{id:3,title:"Out Time ",dataIndex:"outTime",key:"outTime",render:e=>d(e).format("DD-MM-YYYY, h:mm A")||"NONE",renderCsv:e=>d(e).format("DD-MM-YYYY, h:mm A")||"NONE"},{id:4,title:"In Status",dataIndex:"inTimeStatus",key:"inTimeStatus",render:e=>e==="Late"?t.jsx(i,{color:"red",children:e.toUpperCase()}):e==="Early"?t.jsx(i,{color:"blue",children:e.toUpperCase()}):e==="On Time"?t.jsx(i,{color:"green",children:e.toUpperCase()}):t.jsx(i,{style:{color:"orange"},children:"NONE"}),renderCsv:e=>e},{id:5,title:"Out Status",dataIndex:"outTimeStatus",key:"outTimeStatus",render:e=>e==="Late"?t.jsx(i,{color:"red",children:e.toUpperCase()}):e==="Early"?t.jsx(i,{color:"blue",children:e.toUpperCase()}):e==="On Time"?t.jsx(i,{color:"green",children:e.toUpperCase()}):t.jsx(i,{style:{color:"orange"},children:"NONE"}),renderCsv:e=>e},{id:6,title:"Total Hour",dataIndex:"totalHour",key:"totalHour",render:e=>e||"Not Checked",renderCsv:e=>e||"Not Checked"},{id:7,title:"Punch By",dataIndex:"punchBy",key:"punchBy",render:e=>{var r,n;return t.jsx("span",{children:((r=e[0])==null?void 0:r.firstName)+" "+((n=e[0])==null?void 0:n.lastName)||"Not Checked"})},renderCsv:e=>{var r,n;return((r=e[0])==null?void 0:r.firstName)+" "+((n=e[0])==null?void 0:n.lastName)}}];return o.useEffect(()=>{p(A(c))},[p,c]),t.jsx(k,{className:"max-md:border-0 max-md:bg-white",bodyClass:"max-md:p-0 ",headClass:"border-none",title:"Attendance List",extra:t.jsx(B,{permission:"create-attendance",title:"Create Attendance",width:40,children:t.jsx(P,{})}),children:t.jsx(E,{permission:"readAll-attendance",children:t.jsx(w,{columns:j,list:u,total:f,loading:m,setPageConfig:x,title:"Staff List"})})})}export{Z as default};
