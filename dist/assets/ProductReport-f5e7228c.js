import{cM as j,cS as E,cN as t,cL as V,r as y,cO as P,cQ as Q}from"./vendor-3a94a37a.js";import{s as O,aX as S,al as L,fJ as z,C as U,c6 as A}from"./index-ed7845ca.js";import{R as K}from"./ReportTable-b23b8ac7.js";import{i as q}from"./invoiceGenerator-eaeb8720.js";import{u as H}from"./useCurrency-4b14dd3d.js";import{F as b,b as T}from"./vendor-large-f75deccb.js";function F({data:c,info:d,title:x,type:o,btnName:l}){const{currencyName:i}=H()||{},p=j(r=>{var h;return(h=r==null?void 0:r.setting)==null?void 0:h.data})||null,u=[],e=[{label:"Total Product Quantity",value:`${d!=null&&d.totalProductQuantity?Number(d.totalProductQuantity).toFixed(2):""}`},{label:"Total Purchase Price",value:`${d!=null&&d.totalPurchasePrice?Number(d.totalPurchasePrice).toFixed(2):""}`},{label:"Total Sale Price",value:`${d!=null&&d.totalSalePrice?Number(d.totalSalePrice).toFixed(2):""}`}],a=["SL","Name","SKU","Brand ","SubCategory","UoM","Store","QTY","ReOrder QTY","Purchase Price","Sale Price"],s=c==null?void 0:c.map((r,h)=>{var g,C,N,v,D,Y,m,w;return[`${h+1}`,O(r==null?void 0:r.name,75),r==null?void 0:r.sku,(g=r==null?void 0:r.productGroup.productBrand)==null?void 0:g.name,(C=r==null?void 0:r.productGroup.subCategory)==null?void 0:C.name,(N=r==null?void 0:r.productGroup.uom)==null?void 0:N.name,(v=r==null?void 0:r.stockInfo)==null?void 0:v.map(n=>{var R;return(R=n==null?void 0:n.store)==null?void 0:R.name}).join(`
`),(D=r==null?void 0:r.stockInfo)==null?void 0:D.map(n=>n==null?void 0:n.productQuantity).join(`
`),(Y=r==null?void 0:r.stockInfo)==null?void 0:Y.map(n=>n==null?void 0:n.reorderQuantity).join(`
`),(m=r==null?void 0:r.stockInfo)==null?void 0:m.map(n=>n!=null&&n.productPurchasePrice?n==null?void 0:n.productPurchasePrice:0).join(`
`),(w=r==null?void 0:r.stockInfo)==null?void 0:w.map(n=>n!=null&&n.productSalePrice?n==null?void 0:n.productSalePrice:0).join(`
`)]}),M=[],$=[{value:`Report Date: ${E().format("YYYY-MM-DD")}`},{value:`Currency: ${i}`}],B={jsPDF:{orientation:"landscape"},tableFontSize:8,infoTopFontSize:10,bottomRightFontSize:10,bottomLeftFontSize:8,footerFontSize:10,bottomMargin:20};return t.jsx("div",{className:"flex gap-2",children:t.jsx(S,{className:"bg-primary flex  justify-center items-center px-4 py-2 text-white rounded",onClick:()=>q(o,{title:x,TopRightInfo:$,companyInfo:p,customerInfo:M,bottomLeftContent:u,bottomRightContent:e,tableBody:s,tableHead:a,settings:B}),children:l})})}function J({pageConfig:c,setShowTable:d,setPageConfig:x}){const o=V(),{list:l,loading:i}=j(a=>a.store),[p,u]=y.useState(!1),e=async a=>{u(!0),(await o(z({...a,query:"report"}))).payload.message==="success"&&d(!0),u(!1)};return y.useEffect(()=>{o(L())},[o]),t.jsx("div",{className:"flex flex-col items-center gap-2 p-5 m-4 rounded bg-white w-1/3",children:t.jsxs(b,{layout:"vertical",className:"w-full",initialValues:{startDate:P(c.startDate,"YYYY-MM-DD"),endDate:P(c.endDate,"YYYY-MM-DD")},onFinish:e,children:[t.jsx(b.Item,{label:"Select store",name:"storeId",children:t.jsx(T,{placeholder:"All",loading:i,allowClear:!0,maxTagPlaceholder:a=>t.jsxs("div",{className:"",children:[a.length," Selected"]}),maxTagCount:0,mode:"multiple",showSearch:!1,style:{width:"100%"},children:l==null?void 0:l.map(a=>t.jsx(T.Option,{value:a.id,children:a==null?void 0:a.name},a.id))})}),t.jsx(b.Item,{children:t.jsx(S,{loading:p,type:"submit",className:"w-full bg-green-500 text-white rounded p-2",children:"Generate Report"})})]})})}function G(){const[c,d]=y.useState({startDate:P().subtract(1,"month").format("YYYY-MM-DD"),endDate:P().format("YYYY-MM-DD"),store:null}),[x,o]=y.useState(!1),{report:l,info:i,loading:p}=j(e=>e.products),u=[{id:1,title:"ID",dataIndex:"id",key:"id",width:"50px",render:e=>t.jsx(Q,{to:`/admin/product/${e}`,children:e}),renderCsv:e=>e},{id:4,title:"Name",dataIndex:"name",key:"name",render:(e,{id:a})=>t.jsx(Q,{to:`/admin/product/${a}`,children:e}),width:"150px",tdClass:"whitespace-nowrap",renderCsv:e=>e},{id:10,title:"Brand",dataIndex:"productGroup",key:"productBrand",render:e=>{var a;return(a=e==null?void 0:e.productBrand)==null?void 0:a.name},renderCsv:e=>{var a;return(a=e==null?void 0:e.productBrand)==null?void 0:a.name}},{id:9,title:"Sub Category",dataIndex:"productGroup",key:"productSubCategory",render:e=>{var a;return(a=e==null?void 0:e.subCategory)==null?void 0:a.name},renderCsv:e=>{var a;return(a=e==null?void 0:e.subCategory)==null?void 0:a.name}},{id:3,title:"SKU",dataIndex:"sku",key:"sku"},{id:5,title:"UoM",key:"uomValue",render:({productGroup:e})=>{const{uomValue:a,uom:s}=e;return`${a||""}${s!=null&&s.name?`/${s.name}`:""}`},renderCsv:({productGroup:e})=>{const{uomValue:a,uom:s}=e;return`${a||""}${s!=null&&s.name?`/${s.name}`:""}`}},{title:"Store",dataIndex:"stockInfo",render:e=>{var a;return(a=e==null?void 0:e[0].store)==null?void 0:a.name},nestDataIndex:"store",renderNested:e=>e==null?void 0:e.name,renderCsv:e=>e==null?void 0:e.map(a=>{var s;return(s=a.store)==null?void 0:s.name}).join(", "),key:"store"},{id:7,title:"Purchase price",dataIndex:"stockInfo",render:e=>e==null?void 0:e[0].productPurchasePrice,nestDataIndex:"productPurchasePrice",renderNested:e=>e,renderCsv:e=>e==null?void 0:e.map(a=>a.productPurchasePrice).join(", "),key:"productPurchasePrice",tdClass:"whitespace-normal"},{id:8,title:"Sale price",dataIndex:"stockInfo",render:e=>e==null?void 0:e[0].productSalePrice,nestDataIndex:"productSalePrice",renderNested:e=>e,renderCsv:e=>e==null?void 0:e.map(a=>a.productSalePrice).join(", "),key:"productSalePrice"},{id:6,title:"Quantity",dataIndex:"stockInfo",render:e=>e==null?void 0:e[0].productQuantity,nestDataIndex:"productQuantity",renderNested:e=>e,renderCsv:e=>e==null?void 0:e.map(a=>a.productQuantity).join(", "),key:"productQuantity"},{id:12,title:"Reorder QTY",dataIndex:"stockInfo",render:e=>e==null?void 0:e[0].reorderQuantity,nestDataIndex:"reorderQuantity",renderNested:e=>e,renderCsv:e=>e==null?void 0:e.map(a=>a.reorderQuantity).join(", "),key:"reorderQuantity"}];return t.jsx("div",{className:"card card-custom mt-3 ",children:t.jsx("div",{className:"card-body",children:t.jsx(U,{className:"max-md:border-0 max-md:bg-white",bodyClass:"max-md:p-0 ",headClass:"border-none",title:"Inventory Report",children:x?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex py-5  items-start justify-between ",children:[t.jsx("div",{children:t.jsx(S,{onClick:()=>o(e=>!e),className:" bg-green-500 text-white inline-block",children:"Generate Again"})}),t.jsxs("div",{className:"flex  items-start gap-2",children:[t.jsx(F,{data:l,info:i,title:"INVENTORY REPORT",type:"print",btnName:"Print"}),t.jsx(F,{data:l,info:i,title:"INVENTORY REPORT",type:"download",btnName:"Export PDF"}),t.jsx("div",{children:t.jsx(A,{list:l,columns:u,title:"Inventory Report",className:"bg-primary  text-base w-[120px] h-auto py-2 ",btnName:"Export CSV"})})]})]}),t.jsx(K,{list:l,columns:u,loading:p,nestedRowKey:"stockInfo"})]}):t.jsx(J,{setShowTable:o,setPageConfig:d,pageConfig:c})})})})}export{G as default};
