import{cL as P,cM as x,r as u,cN as a}from"./vendor-3a94a37a.js";import{as as f,bk as w,at as n,d as S,C,U as b,T as q}from"./index-ed7845ca.js";import{C as I}from"./CommonDelete-4339174a.js";import{C as A}from"./CreateDrawer-a7af16b9.js";import{u as N}from"./projectApi-2d6ff3a1.js";import{F as i,b as l,I as F,B as v}from"./vendor-large-f75deccb.js";const j=f.injectEndpoints({endpoints:s=>({getProjectTeams:s.query({query:t=>({url:`project-team?${w(t,!1)}`}),providesTags:["ProjectTeams"]}),getProjectTeamByProjectId:s.query({query:t=>({url:`project-team/${t}/project`}),providesTags:["ProjectTeamsById"]}),getProjectTeam:s.query({query:t=>({url:`project-team/${t}`}),providesTags:["ProjectTeam"]}),addProjectTeam:s.mutation({query:t=>({method:"POST",headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},url:"project-team/",body:t}),async onQueryStarted(t,{queryFulfilled:e,dispatch:c}){try{await e,n("ProjectTeam added successfully","success")}catch{n("Something went wrong, Please try again","warning")}},invalidatesTags:["ProjectTeams","ProjectTeamsById"]}),updateProjectTeam:s.mutation({query:({id:t,values:e})=>({method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},url:`project-team/${t}?query=all`,body:e}),async onQueryStarted(t,{queryFulfilled:e,dispatch:c}){try{await e,n("ProjectTeam updated successfully","success")}catch{n("Something went wrong, Please try again","warning")}},invalidatesTags:["ProjectAll","ProjectTeams","ProjectTeam"]}),updateProjectTeamStatus:s.mutation({query:({id:t,values:e})=>({method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},url:`project-team/${t}`,body:e}),async onQueryStarted(t,{queryFulfilled:e,dispatch:c}){try{await e,n("ProjectTeam Status updated successfully","success")}catch{n("Something went wrong, Please try again","warning")}},invalidatesTags:["ProjectAll","ProjectTeams","ProjectTeam"]}),deleteProjectTeam:s.mutation({query:t=>({url:`project-team/${t}`,method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},body:{status:"false"}}),async onQueryStarted(t,{queryFulfilled:e,dispatch:c}){try{await e,n("Deleted ProjectTeam successful","warning")}catch{n("Something went wrong, Please try again","warning")}},invalidatesTags:["ProjectTeams"]})})}),{useGetProjectTeamsQuery:B,useGetProjectTeamByProjectIdQuery:E,useGetProjectTeamQuery:O,useAddProjectTeamMutation:U,useUpdateProjectTeamMutation:H,useUpdateProjectTeamStatusMutation:z,useDeleteProjectTeamMutation:K}=j;function k({projectId:s}){const t=P(),{list:e,loading:c}=x(r=>r.users),{data:o,isLoading:m}=N(),[T,{isLoading:y}]=U(),[d]=i.useForm(),g=async r=>{const h={...r,projectId:r.projectId?r.projectId:parseInt(s)},p=await T(h);p.data&&!p.error&&d.resetFields()};return u.useEffect(()=>{t(S({query:"all"}))},[t]),a.jsx(a.Fragment,{children:a.jsx(i,{form:d,eventKey:"shift-form",name:"basic",layout:"vertical",onFinish:g,autoComplete:"off",className:"m-4",children:a.jsxs("div",{children:[!s&&a.jsx(i.Item,{label:"Project Name",name:"projectId",style:{marginBottom:"10px"},rules:[{required:!s,message:"Select Project"}],children:a.jsx(l,{loading:m,showSearch:!0,allowClear:!0,placeholder:"Select Project",optionFilterProp:"children",children:o==null?void 0:o.map(r=>a.jsx(l.Option,{value:r.id,children:r.name},r.id))})}),a.jsx(i.Item,{style:{marginBottom:"10px"},label:"Team Name",name:"projectTeamName",rules:[{required:!0,message:"Input Team Name"}],children:a.jsx(F,{placeholder:"Team Name"})}),a.jsx(i.Item,{style:{marginBottom:"20px"},label:"Team Member/s",name:"projectTeamMember",rules:[{required:!0,message:"Select Team Member/s"}],children:a.jsx(l,{mode:"multiple",maxTagCount:"responsive",loading:c,placeholder:"Select Team Member/s",optionFilterProp:"children",children:e==null?void 0:e.map(r=>a.jsx(l.Option,{value:r.id,children:r.firstName+" "+r.lastName},r.id))})}),a.jsx(i.Item,{style:{marginBottom:"10px"},wrapperCol:{offset:7,span:12},children:a.jsx(v,{type:"primary",size:"large",htmlType:"submit",block:!0,loading:y,children:"Create Team"})})]})})})}function R(){const[s,t]=u.useState({page:1,count:10}),{data:e,isLoading:c}=B(s),o=[{id:1,title:"ID",dataIndex:"id",key:"id"},{id:3,title:"Team Name",dataIndex:"projectTeamName",key:"projectTeamName"},{id:2,title:"Status",dataIndex:"status",key:"status",render:m=>m?"True":"False"},{id:3,title:"",key:"action",render:({id:m})=>[{label:a.jsx(I,{className:"bg-white text-black",id:m,permission:"delete-projectTeam",deleteThunk:j.endpoints.deleteProjectTeam.initiate,title:"Delete"}),key:"delete"}]}];return a.jsx(C,{className:"max-md:border-0 max-md:bg-white",bodyClass:"max-md:p-0 ",headClass:"border-none",title:"Team",extra:a.jsx(A,{permission:"create-projectTeam",title:"Create Team",width:30,children:a.jsx(k,{})}),children:a.jsx(b,{permission:"readAll-projectTeam",children:a.jsx(q,{list:e==null?void 0:e.getAllProjectTeam,columns:o,loading:c,total:e==null?void 0:e.totalProjectTeam,setPageConfig:t,title:"Team list",isSearch:!0})})})}export{R as default};
