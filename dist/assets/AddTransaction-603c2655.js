import{cS as x,cL as C,cM as g,r as d,cN as e,cO as A}from"./vendor-3a94a37a.js";import{aj as B,az as O,aA as q}from"./index-ed7845ca.js";import{A as I}from"./AddAccount-8cfc0f4b.js";import{B as y}from"./BigDrawer-240149a9.js";import{F as r,b as a,D as Y,I as h,B as L,f as T}from"./vendor-large-f75deccb.js";let k=x().startOf("month").format("YYYY-MM-DD"),E=x().endOf("month").format("YYYY-MM-DD");const G=({preFieldValue:b})=>{const o=C(),{Title:S}=T,{list:c,loading:j}=g(t=>t.accounts),{list:m,loading:w,defaultStore:u}=g(t=>t.store),[l]=r.useForm();let[F,P]=d.useState(x());const[D,i]=d.useState(!1);d.useEffect(()=>{o(B())},[o]),d.useEffect(()=>{u&&l.setFieldValue("storeId",u.id)},[u,l]);const N=async t=>{var s;try{const n={date:F,...t};((s=(await o(O(n))).meta)==null?void 0:s.requestStatus)==="fulfilled"&&(i(!1),o(q({startdate:k,enddate:E}))),l.resetFields(),i(!1)}catch{i(!1)}},v=t=>{i(!1)},f=(t,s)=>{const n=l.getFieldValue("type"),p=l.getFieldValue("relatedId");return!n&&p||n&&!p?Promise.reject("Select type and input related Id"):Promise.resolve()};return e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx(S,{level:4,className:"m-2 text-center",children:"Transaction"}),e.jsxs(r,{form:l,name:"basic",initialValues:{remember:!0,...b},layout:"vertical",className:"sm:mx-10",onFinish:N,onFinishFailed:v,autoComplete:"off",children:[e.jsx(r.Item,{className:"mb-0",name:"storeId",label:"Store",rules:[{required:!0,message:"Store is required"}],children:e.jsx(a,{className:"w-full",loading:w,showSearch:!0,placeholder:"Select a store",optionFilterProp:"children",children:m==null?void 0:m.map(t=>e.jsx(a.Option,{value:t.id,children:t.name},t.id))})}),e.jsx(r.Item,{style:{marginBottom:"10px"},label:"Date",required:!0,children:e.jsx(Y,{defaultValue:A(),onChange:t=>P(t==null?void 0:t._d),label:"date",name:"date",className:"date-picker date-picker-transaction-create",rules:[{required:!0,message:"Please input date!"}]})}),e.jsx("div",{className:"flex items-end mb-[10px]",children:e.jsx(r.Item,{className:"flex-grow  mb-0",name:"debitId",label:e.jsxs(e.Fragment,{children:["Debit Account",e.jsx(y,{title:"new debit account",children:e.jsx(I,{drawer:!0})})]}),rules:[{required:!0,message:"Please input debit account!"}],children:e.jsx(a,{loading:j,showSearch:!0,placeholder:"Select Debit ID",optionFilterProp:"children",filterSort:(t,s)=>t.children.toLowerCase().localeCompare(s.children.toLowerCase()),children:c&&c.map(t=>e.jsx(a.Option,{value:t.id,children:t.name},t.id))})})}),e.jsx("div",{className:"flex items-end mb-[10px]",children:e.jsx(r.Item,{name:"creditId",label:e.jsxs(e.Fragment,{children:["Credit Account",e.jsx(y,{title:"new credit account",children:e.jsx(I,{drawer:!0})})]}),className:"flex-grow mb-0",rules:[{required:!0,message:"Please input debit account!"}],children:e.jsx(a,{loading:j,showSearch:!0,placeholder:"Select Credit ID",optionFilterProp:"children",filterSort:(t,s)=>t.children.toLowerCase().localeCompare(s.children.toLowerCase()),children:c&&c.map(t=>e.jsx(a.Option,{value:t.id,children:t.name},t.id))})})}),e.jsx(r.Item,{style:{marginBottom:"10px"},label:"Amount",name:"amount",rules:[{required:!0,message:"Please input amount!"}],children:e.jsx(h,{type:"number"})}),e.jsx(r.Item,{style:{marginBottom:"10px"},label:"Particulars",name:"particulars",rules:[{required:!0,message:"Please input particulars!"}],children:e.jsx(h,{})}),e.jsx(r.Item,{style:{marginBottom:"10px"},label:"Invoice type - Id",name:"relatedId",rules:[{validator:f}],children:e.jsx(h,{addonBefore:e.jsx(r.Item,{name:"type",rules:[{validator:f}],noStyle:!0,children:e.jsxs(a,{allowClear:!0,size:"small",popupClassName:"min-w-[200px]",style:{width:150},placeholder:"Select type",optionFilterProp:"children",className:"transaction",children:[e.jsx(a.Option,{value:"sale",children:"Sale"}),e.jsx(a.Option,{value:"purchase",children:"Purchase"}),e.jsx(a.Option,{value:"sale_return",children:"Sale Return"}),e.jsx(a.Option,{value:"purchase_return",children:"Purchase Return"})]})}),placeholder:"Enter Invoice Id"})}),e.jsx(r.Item,{style:{marginBottom:"10px"},className:"flex justify-center mt-[24px]",children:e.jsx(L,{type:"primary",htmlType:"submit",shape:"round",loading:D,onClick:()=>i(!0),children:"Pay Now"})})]})]})})};export{G as default};
