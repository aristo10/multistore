import{cM as d,cL as T,r as y,cN as n,cV as E}from"./vendor-3a94a37a.js";import{I as U}from"./ImageUploader-c0ae741f.js";import{t as k,a as z,v as B,w as Q,d as R,U as V,O as D,P as M}from"./index-ed7845ca.js";import{F as o,b as e,B as j}from"./vendor-large-f75deccb.js";function W({onClose:u,createAs:l}){const{list:s,loading:f}=d(a=>a.company),{list:r,loading:w}=d(a=>a.contact),{list:c,loading:I}=d(a=>a.opportunity),{loading:N}=d(a=>a.attachment),{list:h,loading:S}=d(a=>a.quote),{list:m,loading:b}=d(a=>a.users),{loading:C}=d(a=>a.note),[p]=o.useForm(),t=T(),[i,v]=y.useState([]);y.useEffect(()=>{t(k()),t(z()),t(B()),t(Q()),t(R({query:"all"}))},[t]);const q=async a=>{var g,x;if(i.length===0){E.error("Please Select Attachment");return}const L={...a,attachmentPath:(g=i[0])==null?void 0:g.id,attachmentName:(x=i[0])==null?void 0:x.fileName};(await t(D(L))).payload.message==="success"&&(p.resetFields(),l!=null&&l.name?t(l.singleLoadThunk(l.value)):t(M({page:1,count:10})),u())},F=()=>{p.resetFields(),u()},O=a=>{console.log("Failed:",a)},P=a=>{v(a)};return n.jsx("div",{className:"flex justify-center mt-5",children:n.jsx(V,{permission:"create-attachment",children:n.jsxs(o,{className:"w-4/5",onFinish:q,onFinishFailed:O,colon:!1,layout:"vertical",form:p,initialValues:l?{[l==null?void 0:l.name]:l==null?void 0:l.value}:{},children:[n.jsx(o.Item,{label:"Attachment path",name:"attachmentPath",required:!0,children:n.jsx(U,{images:i,setImages:P})}),n.jsx(o.Item,{label:"Attachment owner",name:"attachmentOwnerId",tooltip:"This is a required field",rules:[{required:!0,message:"attachment owner is Required."}],children:n.jsx(e,{style:{width:"100%"},loading:b,allowClear:!0,showSearch:!0,placeholder:"Select note owner name",children:m==null?void 0:m.map(a=>n.jsxs(e.Option,{value:a.id,children:[a==null?void 0:a.firstName," ",a==null?void 0:a.lastName]},a.id))})}),n.jsx(o.Item,{label:"Company",name:"companyId",children:n.jsx(e,{style:{width:"100%"},loading:f,allowClear:!0,showSearch:!0,placeholder:"Select company Name",disabled:(l==null?void 0:l.name)==="companyId",children:s==null?void 0:s.map(a=>n.jsx(e.Option,{value:a.id,children:a.companyName},a.id))})}),n.jsx(o.Item,{label:"Contact",name:"contactId",children:n.jsx(e,{style:{width:"100%"},loading:w,allowClear:!0,showSearch:!0,placeholder:"Select contact",disabled:(l==null?void 0:l.name)==="contactId",children:r==null?void 0:r.map(a=>n.jsx(e.Option,{value:a.id,children:a.fullName?a.fullName:a.firstName+" "+a.lastName},a.id))})}),n.jsx(o.Item,{label:"Opportunity",name:"opportunityId",children:n.jsx(e,{style:{width:"100%"},loading:I,allowClear:!0,showSearch:!0,placeholder:"Select opportunity",disabled:(l==null?void 0:l.name)==="opportunityId",children:c==null?void 0:c.map(a=>n.jsx(e.Option,{value:a.id,children:a.opportunityName},a.id))})}),n.jsx(o.Item,{label:"Quote",name:"quoteId",children:n.jsx(e,{style:{width:"100%"},loading:S,allowClear:!0,showSearch:!0,placeholder:"Select quote",disabled:(l==null?void 0:l.name)==="quoteId",children:h==null?void 0:h.map(a=>n.jsx(e.Option,{value:a.id,children:a.quoteName},a.id))})}),n.jsx(o.Item,{label:"",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(j,{size:"large",htmlType:"submit",type:"primary",loading:N,children:"Create"}),n.jsx(j,{loading:C,size:"large",htmlType:"submit",type:"danger",onClick:F,children:"Cancel"})]})})]})})})}export{W as A};
