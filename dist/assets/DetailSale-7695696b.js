import{cM as R,cS as S,cN as e,cQ as O,cL as Y,r as A,dq as ae,cV as K,d4 as ce,da as ue,cX as de,cU as me,cT as xe,dt as be,dc as pe}from"./vendor-3a94a37a.js";import{fp as V,am as te,s as le,aX as E,b0 as ne,aZ as he,hj as fe,C as L,bt as je,L as Ne}from"./index-ed7845ca.js";import{L as B}from"./List-9eb27318.js";import{T as ge,a as Q}from"./Tabs-8f68912a.js";import{u as M}from"./useCurrency-4b14dd3d.js";import{V as ve}from"./ViewBtn-ffc9b5cb.js";import{S as Ae}from"./SaleProductListCard-76fb09a1.js";import{i as _}from"./invoiceGenerator-eaeb8720.js";import{n as H}from"./numberToWords-4c291141.js";import ye from"./AddTransaction-603c2655.js";import{B as Se}from"./BtnLoader-1c0e147f.js";import{M as Te,F as I,b as q,I as Z,a as J,c as $e,i as Ie,B as Pe,n as Ce,d as G,e as Fe}from"./vendor-large-f75deccb.js";import{s as Re}from"./emailConfigSlice-145edc06.js";import{T as ee}from"./TagInput-f33dd18b.js";import{textEditorModule as we,textEditorFormats as ke}from"./AddProduct-aa890cea.js";function De(t){const{currencySymbol:n}=M()||{},l=R(v=>{var T;return(T=v==null?void 0:v.setting)==null?void 0:T.data})||null,o=V(n),{totalPaidAmount:c,dueAmount:s,singleSaleInvoice:m,totalReturnAmount:p,instantPaidReturnAmount:h}=t||{},{id:j,customer:f,date:d,totalAmount:r,totalDiscountAmount:N,totalTaxAmount:a}=m||{},x=(r||0)+(N||0),y=(r||0)+(a||0)-(p||0)+(h||0),g=`Your order has been placed. Order ID #${j}`,i=`
<div>Dear <strong>${f==null?void 0:f.username}</strong>,</div>
<div>Greetings! We trust this message reaches you in great spirits. We are immensely grateful for the privilege of having you as our esteemed customer.</div>
<br>
<strong>Order Information:</strong><br>
<p>Order ID: ${j}</p>
<p>Order Date: ${S(d).format("ll")}</p>
<br>
<strong>Invoice Details:</strong><br>
Total Amount: ${o}${r?Number(x).toFixed(2):0} <br>
Discount: ${o}${N?Number(N).toFixed(2):0} <br>

Total Tax: ${o}${a?Number(a).toFixed(2):0} <br>
${p?`Return Product Value: ${o}${p?Number(p).toFixed(2):0} <br>`:""}

${h?`Return Amount: ${o}${h?Number(h).toFixed(2):0}<br>`:""}

Grand Total: ${o}${r?Number(y).toFixed(2):0} <br>
Paid Amount: ${o}${c?Number(c).toFixed(2):0}<br>
Due Amount: ${o}${s?Number(s).toFixed(2):0}<br>
<br>
<p>Best Regards,</p>
<p>${l==null?void 0:l.companyName}</p>
<p>${l==null?void 0:l.phone}</p>
<p>${l==null?void 0:l.email}</p>`;return{subject:g,body:i}}const Le=({list:t})=>{const n=[{id:2,title:"ID",dataIndex:"id",key:"id"},{id:4,title:"Total Amount",key:"totalAmount",render:({totalAmount:o,tax:c})=>`${o+(c||0)}`},{id:5,title:"Note",dataIndex:"note",key:"note"},{id:3,title:"Date",dataIndex:"date",key:"date",render:o=>S(o).format("ll")},{id:1,title:"Action",key:"returnSaleInvoiceProduct",render:({id:o})=>e.jsx(ve,{path:`/admin/sale-return-list/${o}`})}],l=o=>o.map(c=>({...c,key:c.id}));return e.jsx("div",{className:"m-1 md:mt-4",children:e.jsx(te,{scroll:{x:!0},loading:!t,columns:n,data:t?l(t):[]})})},Oe=({list:t})=>{const n=[{id:1,title:"ID",dataIndex:"id",key:"id",render:o=>e.jsx(O,{to:`/admin/transaction/${o}`,children:o})},{id:2,title:"Date",dataIndex:"date",key:"date",render:o=>S(o).format("ll")},{id:3,title:"Debit",dataIndex:"debit",key:"debit",render:o=>o.name},{id:4,title:"Credit",dataIndex:"credit",key:"credit",render:o=>o.name},{id:5,title:"Amount",dataIndex:"amount",key:"amount"},{id:6,title:"Type ",dataIndex:"type",key:"type"},{id:7,title:"Particulars",dataIndex:"particulars",key:"particulars",render:o=>e.jsx("div",{title:o,children:le(o,20)})}],l=o=>o.map(c=>({...c,key:c.id}));return e.jsx("div",{className:"m-1 md:mt-4",children:e.jsx(te,{scroll:{x:!0},loading:!t,columns:n,data:t?l(t):[]})})};function Me({sale:t,title:n}){var a,x,y,g;const{singleSaleInvoice:l}=t||{},{currencyName:o}=M()||{},c=R(i=>{var v;return(v=i==null?void 0:i.setting)==null?void 0:v.data})||null,s=H(Math.round(l.totalAmount+(l==null?void 0:l.totalTaxAmount))),m=Number((t.totalAmount||0)+(t.totalTaxAmount||0)+(t.instantPaidReturnAmount||0)-(t.totalReturnAmount||0)),p=[{label:"GRAND TOTAL IN WORDS: ",value:`${s.toUpperCase()} ${o}`||""},{label:"Notes: ",value:l.note?l.note:""},{label:"Terms And Conditions: ",value:l.termsAndConditions?l.termsAndConditions:""}],h=[{label:"Total Amount:",value:`${l!=null&&l.totalAmount?Number(l.totalAmount+((l==null?void 0:l.totalDiscountAmount)||0)).toFixed(2):0}`},{label:"Discount (-)",value:`${l!=null&&l.totalDiscountAmount?Number(l.totalDiscountAmount).toFixed(2):0}`},{label:"Total Tax (+)",value:`${l!=null&&l.totalTaxAmount?Number(l.totalTaxAmount).toFixed(2):0}`},t.totalReturnAmount&&{label:"Return product value (-):",value:`${t.totalReturnAmount?Number(t.totalReturnAmount).toFixed(2):0}`},t.instantPaidReturnAmount&&{label:"Return Amount (+):",value:`${t.instantPaidReturnAmount?Number(t.instantPaidReturnAmount).toFixed(2):0}`},{label:"Grand Total:",value:`${t.totalAmount?m.toFixed(2):0}`,style:{borderTop:!0}},{label:"Paid Amount (-)",value:`${t.totalPaidAmount?Number(t.totalPaidAmount).toFixed(2):0}`},{label:"Due Amount:",value:`${t.dueAmount.toFixed(2)}`,style:{borderTop:!0}}],j=["SL","Name","Quantity","Price","Discount","Amount","Tax"],f=l.saleInvoiceProduct.map((i,v)=>[v+1,i.product.name,i.productQuantity,`${i.productUnitSalePrice}`,`${i.productDiscount||0}`,`${i.productFinalAmount}`,`${i.taxAmount}`]),d=[{value:`Client Name: ${(a=l==null?void 0:l.customer)==null?void 0:a.username}`},{value:`Address: ${(x=l==null?void 0:l.customer)!=null&&x.address?(y=l==null?void 0:l.customer)==null?void 0:y.address:""}`},{value:`Contact No: ${(g=l==null?void 0:l.customer)==null?void 0:g.phone}`}],r=[{value:` Invoice No: ${l==null?void 0:l.id}`},{value:`Invoice Date: ${S(l==null?void 0:l.date).format("YYYY-MM-DD")}`},{value:`Currency: ${o}`}];l!=null&&l.dueDate&&r.splice(2,0,{value:`Due Date: ${S(l==null?void 0:l.dueDate).format("YYYY-MM-DD")}`});const N={jsPDF:{},tableFontSize:10,infoTopFontSize:10,bottomRightFontSize:10,bottomLeftFontSize:8,footerFontSize:10};return e.jsx("div",{className:"flex gap-2",children:e.jsx(E,{color:"primary",onClick:()=>_("print",{title:n,TopRightInfo:r,companyInfo:c,customerInfo:d,bottomLeftContent:p,bottomRightContent:h,tableBody:f,tableHead:j,settings:N,leftBottomSecondColumnX:55}),children:"Print"})})}function Be({data:t,title:n}){var d,r,N,a;const{currencySymbol:l}=M()||{},o=R(x=>{var y;return(y=x==null?void 0:x.setting)==null?void 0:y.data})||null;Y(),H(Math.round(t.totalAmount-t.discount)),V(l);const c=[],s=[],m=["SI","Product Description","Quantity"],p=t.saleInvoiceProduct.map(x=>[x.id,x.product.name,x.productQuantity]),h=[{value:`Client Id: ${t==null?void 0:t.customerId}`},{value:`Client Name: ${(d=t==null?void 0:t.customer)==null?void 0:d.username}`},{value:`Address: ${(r=t==null?void 0:t.customer)!=null&&r.address?(N=t==null?void 0:t.customer)==null?void 0:N.address:""}`},{value:`Contact No: ${(a=t==null?void 0:t.customer)==null?void 0:a.phone}`}],j=[{value:` Invoice No: ${t==null?void 0:t.id}`},{value:`Invoice Date: ${S(t==null?void 0:t.date).format("YYYY-MM-DD")}`}],f={jsPDF:{},tableFontSize:10,infoTopFontSize:10,bottomRightFontSize:12,bottomLeftFontSize:8,footerFontSize:10};return e.jsx("div",{onClick:()=>_("print",{title:n,TopRightInfo:j,companyInfo:o,customerInfo:h,bottomLeftContent:c,bottomRightContent:s,tableBody:p,tableHead:m,settings:f}),children:"Print Packing Slip"})}const oe=A.forwardRef(({data:t,invoiceData:n},l)=>{const{currencySymbol:o}=M(),c=V(o),{singleSaleInvoice:s,instantPaidReturnAmount:m,totalReturnAmount:p,totalPaidAmount:h,dueAmount:j}=t||{},f=Number((s.totalAmount||0)+((s==null?void 0:s.totalTaxAmount)||0)-(p||0)+(m||0)),d=[{title:"Total Amount",value:s.totalAmount+(s==null?void 0:s.totalDiscountAmount)},{title:"Discount (-)",value:s.totalDiscountAmount},{title:"Total Tax (+)",value:s.totalTaxAmount},{title:"Return Product Value (-)",value:p,hidden:p===0},{title:"Return Amount (+)",value:m,hidden:m===0},{title:"Grand Total",value:f},{title:"Paid Amount (-)",value:h||0},{title:"Due",value:j}];return e.jsx(A.Fragment,{children:e.jsx("div",{ref:l,className:"pos",children:e.jsxs("div",{className:"font-Inconsolata text-black text-[12px] font-[500]",children:[e.jsxs("div",{className:"text-xs text-center",children:[e.jsx("h3",{className:"font-bold text-xl",children:n==null?void 0:n.companyName}),e.jsx("div",{className:"",children:n==null?void 0:n.tagLine}),e.jsx("div",{className:"",children:n==null?void 0:n.address}),e.jsx("div",{className:"phone",children:n==null?void 0:n.phone}),e.jsx("div",{className:"email",children:n==null?void 0:n.email}),e.jsxs("div",{className:"website",children:[n==null?void 0:n.website," "]}),(n==null?void 0:n.bin)&&e.jsx("div",{className:"",children:e.jsxs("div",{children:["BIN: ",n==null?void 0:n.bin]})}),(n==null?void 0:n.mushak)&&e.jsx("div",{className:"",children:e.jsxs("div",{children:["Musak: ",n==null?void 0:n.mushak]})}),e.jsxs("div",{children:["BILL NO: ",s==null?void 0:s.saleInvoiceProduct[0].invoiceId]}),e.jsxs("div",{children:["DATE: ",S(s==null?void 0:s.date).format("YYYY-MM-DD")]})]}),e.jsxs("table",{className:"w-full table mt-4",children:[e.jsxs("tr",{className:"header text-left",children:[e.jsx("th",{className:"text-[12px]",children:"Item Name"})," ",e.jsxs("th",{className:"text-[12px] whitespace-nowrap",children:["Rate ",e.jsxs("span",{className:"text-[10px]",children:["(",c,")"]})]})," ",e.jsx("th",{className:"text-[12px] pl-2",children:"Qty"}),e.jsxs("th",{className:"text-[12px] pl-1 text-right whitespace-nowrap",children:["Amount ",e.jsxs("span",{className:"text-[10px]",children:["(",c,")"]})]})]}),s&&s.saleInvoiceProduct.map(r=>e.jsxs("tr",{className:"data text-left",children:[e.jsx("td",{className:"text-[12px] whitespace-normal tracking-wide align-top",children:le(r.product.name,50)}),e.jsx("td",{className:"text-[12px] whitespace-nowrap tracking-wide align-top",children:r.productUnitSalePrice}),e.jsx("td",{className:"text-[12px] whitespace-nowrap tracking-wide pl-2 align-top",children:r.productQuantity}),e.jsx("td",{className:"text-[12px] whitespace-nowrap tracking-wide pl-1 text-right align-top",children:r.productQuantity*r.productUnitSalePrice})]},r.id))]}),e.jsx("div",{className:"w-full border-b border-black"}),e.jsx("div",{className:"w-full flex justify-end items-end",children:e.jsx("div",{className:"w-[60%]",children:d.map((r,N)=>r.hidden?null:e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("div",{className:"text-left",children:e.jsxs("span",{className:"text-[12px]",children:[r.title,":"]})}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:"text-[12px]",children:r.value})})]},N))})}),(s==null?void 0:s.termsAndConditions)&&e.jsx("div",{className:"text-center mt-4",children:e.jsxs("p",{className:"",children:[e.jsx("span",{className:"text-sm",children:"Terms and Conditions:"})," ",s.termsAndConditions]})}),e.jsx("div",{className:"text-center text-[12px] mt-2 border-b border-black",dangerouslySetInnerHTML:{__html:n==null?void 0:n.footer}}),e.jsx("div",{className:"text-center text-[12px]",children:"Powered by 2025 | +88018"})]})})})});oe.displayName="printToPdf";const Ee=({data:t})=>{const n=A.useRef(),l=ae.useReactToPrint({content:()=>n.current}),o=R(c=>{var s;return(s=c==null?void 0:c.setting)==null?void 0:s.data})||null;return e.jsxs("div",{children:[e.jsx("div",{className:"hidden",children:e.jsx(oe,{ref:n,data:t,invoiceData:o})}),o&&e.jsx("div",{onClick:l,children:"POS Print"})]})},Ye=async({saleId:t,orderStatus:n})=>{try{return{response:await ce.patch("sale-invoice/order/",{invoiceId:t,orderStatus:n}),message:"success"}}catch{}},ze=({saleId:t})=>{const{Option:n}=q,[l,o]=A.useState(!1),[c,s]=A.useState(!1),m=Y();A.useEffect(()=>{s(!1)},[]);const p=()=>{o(!0)},h=()=>{o(!1)},j=()=>{o(!1)},f=async d=>{s(!0);const{message:r}=await Ye({saleId:t,orderStatus:d});r==="success"?(s(!1),K.success("Order Status Updated"),m(ne(t)),o(!1)):(K.error("Something went wrong"),s(!1))};return e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:p,children:"Status"}),e.jsxs(Te,{title:"Update Order Status",open:l,onOk:h,onCancel:j,children:[e.jsxs(I,{layout:"vertical",children:[e.jsxs("h1",{className:"text-lg text-center font-semibold text-gray-600",children:[" ","Order ID : ",t," "]}),e.jsx(I.Item,{label:"Update Order Status",children:e.jsxs(q,{placeholder:"Select Order Status",style:{width:"100%"},onChange:f,children:[e.jsx(n,{value:"pending",children:"Pending"}),e.jsx(n,{value:"received",children:"Received"})]})})]}),e.jsx(I.Item,{children:c&&e.jsx(Se,{})})]})]})};function Ue(t,n,l,o){var a,x,y,g,i,v,T,F,P,w,k,u,b,D,C;const c=H(Math.round(t.singleSaleInvoice.totalAmount+(t==null?void 0:t.singleSaleInvoice.totalTaxAmount))),s=(t.singleSaleInvoice.totalAmount||0)+(t.singleSaleInvoice.totalDiscountAmount||0),m=(t.singleSaleInvoice.totalAmount||0)+(((a=t==null?void 0:t.singleSaleInvoice)==null?void 0:a.totalTaxAmount)||0)-(t.totalReturnAmount||0)+(t.instantPaidReturnAmount||0),p=[{label:"IN WORDS: ",value:`${c.toUpperCase()} ${o}`||""},{label:"Terms And Conditions: ",value:(x=t==null?void 0:t.singleSaleInvoice)!=null&&x.termsAndConditions?t.singleSaleInvoice.termsAndConditions:""},{label:"Notes: ",value:(y=t==null?void 0:t.singleSaleInvoice)!=null&&y.note?t.singleSaleInvoice.note:""}],h=[{label:"Total Amount:",value:`${t!=null&&t.totalAmount?Number(s).toFixed(2):0}`},{label:"Discount",value:`${t!=null&&t.singleSaleInvoice.totalDiscountAmount?Number(t.singleSaleInvoice.totalDiscountAmount).toFixed(2):0}`},{label:"Total Tax:",value:`${(g=t==null?void 0:t.singleSaleInvoice)!=null&&g.totalTaxAmount?Number(t.singleSaleInvoice.totalTaxAmount).toFixed(2):0}`},t.totalReturnAmount&&{label:"Return product value:",value:`${t.totalReturnAmount?Number(t.totalReturnAmount).toFixed(2):0}`},t.instantPaidReturnAmount&&{label:"Return Amount:",value:`${t.instantPaidReturnAmount?Number(t.instantPaidReturnAmount).toFixed(2):0}`},t.totalAmount&&{label:"Grand Total:",value:`${t.totalAmount?Number(m).toFixed(2):0}`,style:{borderTop:!0}},{label:"Paid Amount:",value:`${t.totalPaidAmount?Number(t.totalPaidAmount).toFixed(2):0}`},{label:"Due Amount:",value:`${t.dueAmount.toFixed(2)}`,style:{borderTop:!0}}],j=["SL","Product Description","Quantity","Unit Price","Total Price","Tax"],f=t.singleSaleInvoice.saleInvoiceProduct.map(($,z)=>[z+1,$.product.name,$.productQuantity,`${$.productUnitSalePrice}`,`${$.productUnitSalePrice*$.productQuantity}`,`${$.taxAmount?$.taxAmount:0}`]),d=[{value:`Client Name: ${(v=(i=t==null?void 0:t.singleSaleInvoice)==null?void 0:i.customer)==null?void 0:v.username}`},{value:`Address: ${(F=(T=t==null?void 0:t.singleSaleInvoice)==null?void 0:T.customer)!=null&&F.address?(w=(P=t==null?void 0:t.singleSaleInvoice)==null?void 0:P.customer)==null?void 0:w.address:""}`},{value:`Contact No: ${(u=(k=t==null?void 0:t.singleSaleInvoice)==null?void 0:k.customer)==null?void 0:u.phone}`}],r=[{value:` Invoice No: ${(b=t==null?void 0:t.singleSaleInvoice)==null?void 0:b.id}`},{value:`Invoice Date: ${S((D=t==null?void 0:t.singleSaleInvoice)==null?void 0:D.date).format("YYYY-MM-DD")}`},{value:`Currency: ${o}`}];return t!=null&&t.dueDate&&r.splice(2,0,{value:`Due Date: ${S((C=t==null?void 0:t.singleSaleInvoice)==null?void 0:C.dueDate).format("YYYY-MM-DD")}`}),_(null,{title:l,TopRightInfo:r,customerInfo:d,companyInfo:n,bottomLeftContent:p,bottomRightContent:h,tableBody:f,tableHead:j,settings:{jsPDF:{},tableFontSize:10,infoTopFontSize:10,bottomRightFontSize:10,bottomLeftFontSize:7,footerFontSize:10},leftBottomSecondColumnX:28})}function Qe({setSendEmail:t,body:n,invoice:l,subject:o,customerEmail:c}){const[s]=I.useForm(),m=Y(),[p,h]=A.useState(!1),[j,f]=A.useState([]),[d,r]=A.useState([]),[N,a]=A.useState([]),{sale:x,loading:y}=R(u=>u.sales),g=R(u=>{var b;return(b=u==null?void 0:u.setting)==null?void 0:b.data})||null,[i,v]=A.useState(n),{currencyName:T}=M()||{},F=async u=>{h(!0);try{let b=new FormData;u.receiverEmail&&b.append("receiverEmail",u.receiverEmail),u.subject&&b.append("subject",u.subject),i&&b.append("body",i),j&&j.forEach(C=>{C.name===`Sale invoice - ${l.id} .pdf`?b.append("files[]",C.originFileObj,`Sale invoice - ${l.id} .pdf`):b.append("files[]",C.originFileObj)}),d.length>0&&b.append("cc[]",d),N.length>0&&b.append("bcc[]",N),(await m(Re(b))).payload.message==="success"&&(t(!1),h(!1),s.resetFields(),r([]),a([]),f(null))}catch(b){console.log(b)}h(!1)},P=()=>{};A.useEffect(()=>{!g&&m(he())},[g,m]);const w=u=>{f(u.fileList)};A.useEffect(()=>{x&&g&&f(u=>u.some(b=>b.name===`Sale invoice - ${l.id} .pdf`)?u:[...u,{name:`Sale invoice - ${l.id} .pdf`,originFileObj:Ue(x,g,"Sale Invoice",T)}])},[x,g,T,l.id]);const k=u=>{v(u)};return e.jsx(e.Fragment,{children:!y&&x&&e.jsxs("div",{className:"py-4 px-4 border-t",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:""}),e.jsx("button",{onClick:()=>t(!1),className:"bg-red-100 p-1 rounded text-red-500",children:e.jsx(ue,{size:20})})]}),e.jsxs(I,{onFinish:F,onFinishFailed:P,colon:!1,layout:"vertical",form:s,initialValues:{subject:o,body:n,receiverEmail:c},children:[e.jsx(I.Item,{style:{width:"100%"},label:"To",rules:[{required:!0,message:"Please input receiver email!"}],name:"receiverEmail",children:e.jsx(Z,{placeholder:"Receiver Email"})}),e.jsx(J,{bordered:!1,defaultActiveKey:["0"],expandIcon:({isActive:u})=>e.jsx($e,{rotate:u?90:0}),className:"site-collapse-custom-collapse mb-4 ",children:e.jsxs(J.Panel,{header:"CC & BCC",children:[e.jsx(ee,{label:"CC",tags:d,setTags:r}),e.jsx(ee,{label:"BCC",tags:N,setTags:a})]},"1")}),e.jsx(I.Item,{style:{width:"100%"},label:"Subject",name:"subject",children:e.jsx(Z,{placeholder:"Subject"})}),e.jsx(I.Item,{label:"Attachment",children:e.jsxs(Ie,{name:"files",fileList:j,onChange:w,multiple:!0,beforeUpload:()=>!1,children:[e.jsx("div",{className:"ant-upload-drag-icon flex justify-center my-2",children:e.jsx(de,{size:30})}),e.jsx("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})}),e.jsx(I.Item,{style:{marginBottom:"25px"},label:"Body",children:e.jsx(me,{value:i,onChange:k,modules:we,formats:ke})}),e.jsx(I.Item,{children:e.jsx(Pe,{loading:p,size:"large",htmlType:"submit",type:"primary",children:"Send"})})]})]})})}function se(t){const n=S(t);if(S()>n)return"Overdue"}const Ge=()=>{var W;const{id:t}=xe(),[n,l]=A.useState(!1),[o,c]=A.useState(!1),s=Y(),m=R(U=>{var X;return(X=U==null?void 0:U.sales)==null?void 0:X.sale}),{subject:p,body:h}=De(m),{status:j,totalPaidAmount:f,totalReturnAmount:d,instantPaidReturnAmount:r,dueAmount:N,singleSaleInvoice:a,returnSaleInvoice:x,transactions:y}=m||{},{id:g,customer:i,totalAmount:v,profit:T,totalDiscountAmount:F,totalTaxAmount:P,note:w,termsAndConditions:k,dueDate:u,user:b,createdAt:D,orderStatus:C,store:$}=a||{},z=(v||0)+(F||0),re=(v||0)+(P||0)-(d||0)+(r||0);A.useEffect(()=>(s(ne(t)),()=>{s(fe())}),[t,s]);const ie=(W=a==null?void 0:a.customer)==null?void 0:W.email;return e.jsxs(e.Fragment,{children:[a?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex gap-2 md:gap-4",children:[e.jsxs(L,{className:"w-2/3",bodyClass:"p-0",children:[e.jsx("div",{className:"flex justify-between mx-2 py-2 border-b items-center",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"text-end ",children:e.jsx(Me,{sale:m,title:"Sale Invoice"})}),e.jsx(E,{className:"flex-row-reverse",color:"gray",icon:e.jsx(be,{size:15}),onClick:()=>l(!0),children:"Send"}),e.jsx(Ce,{content:e.jsx(je,{items:[{key:"1",label:e.jsx(O,{to:`/admin/payment/customer/${g}`,state:{dueAmount:N},children:"Payment"})},{key:"status",label:e.jsx(ze,{saleId:g})},{key:"2",label:e.jsx(O,{to:`/admin/sale/return/${t}`,children:"Return"})},{key:"3",label:a&&e.jsx(Be,{title:"packing slip",data:a})},{key:"4",label:e.jsx(Ee,{data:m})}]}),placement:"bottomRight",arrow:!1,trigger:"click",children:e.jsx(E,{color:"gray",icon:e.jsx(pe,{size:15}),className:"  px-3"})})]})}),n?e.jsx("div",{children:e.jsx(Qe,{body:h,subject:p,setSendEmail:l,customerEmail:ie,invoice:a})}):e.jsxs(ge,{className:"mt-4",children:[e.jsx(Q,{label:"Products",children:e.jsx(Ae,{list:a.saleInvoiceProduct})}),e.jsx(Q,{label:"Return products",children:e.jsx(Le,{list:x})}),e.jsx(Q,{label:"Transactions",children:e.jsx(Oe,{list:y})})]})]}),e.jsxs("div",{className:"w-1/3 flex flex-col gap-2 md:gap-4",children:[e.jsx(L,{title:e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"font-normal",children:["Invoice No"," ",e.jsxs("span",{className:"font-semibold",children:["#",g]})]})}),children:e.jsx(e.Fragment,{children:e.jsx(B,{labelClassName:"w-[40%]",list:[{label:"Invoice Date",value:S(D).format("ll")},{label:"Due Date",value:u?e.jsxs("div",{className:"flex gap-1 items-center",children:[S(u).format("ll"),se(u)&&e.jsx(G,{className:"text-xs",color:"red",children:"Overdue"})]}):"N/A"},{label:"Delivery",value:e.jsx(G,{color:C==="RECEIVED"?"success":"orange",children:C})},{label:"Payment",value:e.jsx(G,{color:j==="PAID"?"green":"red",children:j})},{label:"Sales Person",value:b?e.jsx(O,{to:`/admin/hrm/staff/${a.userId}`,children:`${b.username}`}):"N/A"},{label:"Store",value:$?$==null?void 0:$.name:"N/A"}]})})}),e.jsx(L,{title:"Payment Details",children:e.jsx(B,{labelClassName:"w-[40%]",list:[{label:"Profit",value:T?Number(T).toFixed(2):0,valueClass:T<0?"text-red-500 font-bold":"text-green-500 font-bold"},{label:"Sales Commission",value:a.saleCommission?a.saleCommission.toFixed(2):0,className:"border-b pb-2"},{label:"Total Amount",value:Number(z).toFixed(2)},{label:"Discount",value:e.jsx("div",{className:"before:content-['-'] relative before:absolute before:text-red-500 before:font-bold before:-left-3 before:top-0",children:F?Number(F).toFixed(2):0}),hidden:(a==null?void 0:a.totalDiscountAmount)===0},{label:"Total Tax",value:e.jsx("div",{className:"before:content-['+'] relative before:absolute before:text-green-500 before:font-bold before:-left-3 before:top-0",children:P?Number(P).toFixed(2):0}),hidden:P===0},{label:"Return Product Value",value:e.jsx("div",{className:"before:content-['-'] relative before:absolute before:text-red-500 before:font-bold before:-left-3 before:top-0",children:d?Number(d).toFixed(2):0}),hidden:d===0&&r===0},{label:"Return Amount",value:e.jsxs("div",{className:"before:content-['+'] relative before:absolute before:text-green-500 before:font-bold before:-left-3 before:top-0",children:[r?Number(r).toFixed(2):0,d!=r&&e.jsx(E,{onClick:()=>c(!0),className:"absolute right-4 -top-[23px] inline-block w-auto min-w-[100px] border-blue-400 border-[1.5px] rounded px-3",children:"Make Refund"})]}),hidden:d===0&&r===0},{label:"Grand Total",value:e.jsx("div",{className:"before:content-['='] relative before:absolute before:text-green-500 before:font-bold before:-left-3 before:top-0",children:v?re.toFixed(2):0}),className:"border-t pt-2"},{label:"Paid Amount",value:e.jsx("div",{className:"before:content-['-'] relative before:absolute before:text-red-500 before:font-bold before:-left-3 before:top-0",children:f?Number(f).toFixed(2):0}),className:"border-b pb-1"},{label:"Due Amount",value:N?Number(N).toFixed(2):0}]})}),e.jsx(L,{title:"Customer Details",children:e.jsx(B,{labelClassName:"w-[40%]",list:[{label:"Name",value:e.jsx(O,{to:`/admin/customer/${i==null?void 0:i.id}`,children:i==null?void 0:i.username})},{label:"Phone",value:i==null?void 0:i.phone},{label:"Email",value:(i==null?void 0:i.email)||"N/A"},{label:"Address",value:i==null?void 0:i.address}]})}),e.jsx(L,{children:e.jsx(B,{labelClassName:"w-[40%] font-bold",list:[{label:"Note",value:w,className:"flex-col gap-1"},{label:"Terms and Conditions",value:k,className:"flex-col gap-1"}]})})]})]})}):e.jsx(Ne,{}),e.jsx(Fe,{title:"Make Refund",width:"40%",onClose:()=>c(!1),open:o,bodyStyle:{paddingBottom:80},children:e.jsx(ye,{preFieldValue:{relatedId:a==null?void 0:a.id,type:"sale_return"}})})]})},rt=Object.freeze(Object.defineProperty({__proto__:null,dateDiffChecker:se,default:Ge},Symbol.toStringTag,{value:"Module"}));export{rt as D,Qe as S,se as d};
