import{cM as o,cL as I,c_ as b,r as k,cN as t}from"./vendor-3a94a37a.js";import{bf as F,G as N,bg as C}from"./index-ed7845ca.js";import{F as s,I as n,b as d,s as P,B as T,U as E}from"./vendor-large-f75deccb.js";const S=localStorage.getItem("id"),{Dragger:A}=E,{Option:g}=d,G=()=>{const{loading:u,list:i}=o(e=>e.ticketCategory),{loading:x,list:l}=o(e=>e.priority),{loading:h}=o(e=>e.ticket),r=I(),[p]=s.useForm(),j=b();k.useEffect(()=>{r(F()),r(N())},[r]);const y=async e=>{try{const a=new FormData;if(a.append("customerId",parseInt(S)),a.append("email",e.email),a.append("subject",e.subject),a.append("description",e.description),a.append("ticketCategoryId",e.ticketCategoryId),a.append("priorityId",e.priorityId),e.files)for(let c=0;c<e.files.length;c++)a.append("files[]",e.files[c].originFileObj);const m=await r(C(a));m.payload.message==="success"&&(p.resetFields(),j(`/admin/crm/ticket/${m.payload.data.ticketId}`))}catch{}},f=e=>{console.log("Failed:",e)};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"max-w-screen-md mx-auto p-5 mt-1",children:[t.jsxs("div",{className:"text-center mb-8  ",children:[t.jsx("p",{className:"mt-4 text-sm leading-7 text-gray-500 font-regular uppercase",children:"Support"}),t.jsx("h3",{className:"text-3xl sm:text-4xl leading-normal font-extrabold tracking-tight text-indigo-700",children:"CREATE A TICKET"})]}),t.jsxs(s,{name:"ticketForm",className:"w-full bg-gray-50  p-5 rounded-lg",onFinish:y,form:p,onFinishFailed:f,layout:"vertical",children:[t.jsx(s.Item,{name:"email",label:"Email Address",tooltip:"We'll use this email to contact you",children:t.jsx(n,{placeholder:"youremail@something.com"})}),t.jsx(s.Item,{name:"ticketCategoryId",label:"Ticket Category",rules:[{required:!0,message:"Please select the ticket category"}],children:t.jsx(d,{loading:u,placeholder:"Select a category",children:i==null?void 0:i.map(e=>t.jsx(g,{value:e.id,children:e.ticketCategoryName},e.id))})}),t.jsx(s.Item,{name:"priorityId",label:"Priority",rules:[{required:!0,message:"Please select the priority"}],children:t.jsx(d,{loading:x,placeholder:"Select a priority",children:l==null?void 0:l.map(e=>t.jsx(g,{value:e.id,children:e.name},e.id))})}),t.jsx(s.Item,{name:"subject",label:"Subject",rules:[{required:!0,message:"Please enter the subject"}],children:t.jsx(n,{placeholder:"Fix issue"})}),t.jsx(s.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter the description"}],children:t.jsx(n.TextArea,{rows:4,placeholder:"In the ticket"})}),t.jsx(s.Item,{name:"files",label:"Attachments",valuePropName:"fileList",getValueFromEvent:e=>e&&e.fileList,children:t.jsxs(A,{accept:".png,.jpg,.jpeg,.pdf,.doc,.docx",multiple:!0,beforeUpload:()=>!1,children:[t.jsx("p",{className:"ant-upload-drag-icon",children:t.jsx(P,{})}),t.jsx("p",{className:"ant-upload-text",children:"Drag and drop a files or click to select a files"}),t.jsx("p",{className:"ant-upload-hint",children:"Supported files types: PNG, JPG, JPEG, PDF"})]})}),t.jsx(s.Item,{children:t.jsx(T,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:h,children:"Create Ticket"})})]})]})})};export{G as default};
