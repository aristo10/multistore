import{cM as A,cS as m,cN as e,cL as g,r as j,cO as R,cQ as F}from"./vendor-3a94a37a.js";import{aX as N,aU as k,al as C,fP as L,C as z,c6 as E}from"./index-ed7845ca.js";import{R as O}from"./ReportTable-b23b8ac7.js";import{i as q}from"./invoiceGenerator-eaeb8720.js";import{u as B}from"./useCurrency-4b14dd3d.js";import{F as p,b as y,D as f}from"./vendor-large-f75deccb.js";function $({data:o,pageConfig:l,supplier:c,title:i,info:t,type:d,btnName:h}){const{currencyName:n}=B()||{},D=A(r=>{var b;return(b=r==null?void 0:r.setting)==null?void 0:b.data})||null,x=[],s=[{label:"Total",value:`${t!=null&&t.totalAmount?t.totalAmount.toFixed(2):0}`},{label:"Paid",value:`${t!=null&&t.paidAmount?t.paidAmount.toFixed(2):0}`},{label:"Due",value:`${t!=null&&t.dueAmount?t.dueAmount.toFixed(2):0}`},{label:"Return",value:`${t!=null&&t.totalReturnAmount?t.totalReturnAmount.toFixed(2):0}`},{label:"Instant Paid Return ",value:`${t!=null&&t.instantPaidReturnAmount?t.instantPaidReturnAmount.toFixed(2):0}`}],S=["SL","Date","Invoice","Supplier","Product ","QTY","Total","Paid","Due","Return"],a=o.map((r,b)=>{var P,w,M;return[`${b+1}`,m(r.date).format("YYYY-MM-DD"),r.id,(P=r.supplier)==null?void 0:P.name,(w=r==null?void 0:r.purchaseInvoiceProduct)==null?void 0:w.map(u=>{var I;return(I=u==null?void 0:u.product)==null?void 0:I.name}).join(`,
`),(M=r==null?void 0:r.purchaseInvoiceProduct)==null?void 0:M.map(u=>u==null?void 0:u.productQuantity).join(`
`),`${r.totalAmount?r.totalAmount:0}`,`${r.paidAmount?r.paidAmount:0}`,`${r.dueAmount?r.dueAmount:0}`,`${r.returnAmount?r.returnAmount:0}`]}),Y=[{value:`Supplier: ${c||"All"}`,style:{bold:!0,fontSize:12}}],v=[{value:`From Date: ${m(l==null?void 0:l.startDate).format("YYYY-MM-DD")}`},{value:`To Date: ${m(l==null?void 0:l.endDate).format("YYYY-MM-DD")}`},{value:`Currency: ${n}`}],T={jsPDF:{orientation:"landscape"},tableFontSize:8,infoTopFontSize:10,bottomRightFontSize:10,bottomLeftFontSize:8,footerFontSize:10};return e.jsx("div",{className:"flex gap-2",children:e.jsx(N,{className:"bg-primary flex justify-center items-center px-4 py-2 text-white rounded",onClick:()=>q(d,{title:i,TopRightInfo:v,companyInfo:D,customerInfo:Y,bottomLeftContent:x,bottomRightContent:s,tableBody:a,tableHead:S,settings:T}),children:h})})}function G({pageConfig:o,setSupplier:l,setShowTable:c,setPageConfig:i}){const t=g(),{list:d,loading:h}=A(a=>a.suppliers),{list:n,loading:D}=A(a=>a.store),[x,s]=j.useState(!1),S=async a=>{s(!0),(await t(L({...a,startDate:a.startDate.format("YYYY-MM-DD"),endDate:a.endDate.format("YYYY-MM-DD"),query:"report"}))).payload.message==="success"&&c(!0),s(!1)};return j.useEffect(()=>{t(k({query:"all"})),t(C())},[t]),e.jsx("div",{className:"flex flex-col items-center gap-2 p-5 m-4 rounded bg-white w-1/3",children:e.jsxs(p,{layout:"vertical",className:"w-full",initialValues:{startDate:R(o.startDate,"YYYY-MM-DD"),endDate:R(o.endDate,"YYYY-MM-DD")},onFinish:S,children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx(p.Item,{label:"Select Supplier",name:"supplierId",className:"w-1/2",children:e.jsx(y,{placeholder:"All",loading:h,allowClear:!0,showSearch:!1,style:{width:"100%"},maxTagCount:0,onChange:a=>{var Y;return l((Y=d.find(v=>v.id===a))==null?void 0:Y.name)},children:d==null?void 0:d.map(a=>e.jsx(y.Option,{value:a.id,children:a==null?void 0:a.name},a.id))})}),e.jsx(p.Item,{label:"Select store",name:"storeId",className:"w-1/2",children:e.jsx(y,{placeholder:"All",loading:D,allowClear:!0,maxTagPlaceholder:a=>e.jsxs("div",{className:"",children:[a.length," Selected"]}),maxTagCount:0,mode:"multiple",showSearch:!1,style:{width:"100%"},children:n==null?void 0:n.map(a=>e.jsx(y.Option,{value:a.id,children:a==null?void 0:a.name},a.id))})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(p.Item,{label:"From",name:"startDate",className:"w-1/2",children:e.jsx(f,{onChange:a=>i({...o,startDate:a.format("YYYY-MM-DD")})})}),e.jsx(p.Item,{label:"To",name:"endDate",className:"w-1/2",children:e.jsx(f,{onChange:a=>i({...o,endDate:a.format("YYYY-MM-DD")})})})]}),e.jsx(p.Item,{children:e.jsx(N,{loading:x,type:"submit",className:"w-full bg-green-500 text-white rounded p-2",children:"Generate Report"})})]})})}function K(){const[o,l]=j.useState(!1),[c,i]=j.useState(null),{list:t,loading:d,information:h}=A(s=>s.purchases),[n,D]=j.useState({query:"report",startDate:m().startOf("month").format("YYYY-MM-DD"),endDate:m().endOf("month").format("YYYY-MM-DD")}),x=[{id:1,title:"ID",key:"id",render:({id:s})=>e.jsx(F,{to:`/admin/purchase/${s}`,children:s}),renderCsv:s=>s},{id:2,title:"Date",dataIndex:"date",key:"date",render:s=>m(s).format("ll"),renderCsv:s=>m(s).format("ll")},{id:3,title:"Supplier Name ",dataIndex:"supplier",key:"supplierId",render:s=>e.jsx(F,{to:`/admin/supplier/${s==null?void 0:s.id}`,children:s==null?void 0:s.name}),renderCsv:s=>s==null?void 0:s.name},{id:4,title:"Total Amount",dataIndex:"totalAmount",key:"totalAmount"},{id:5,title:"Discount",dataIndex:"discount",key:"discount"},{id:7,title:"Paid Amount",dataIndex:"paidAmount",key:"paidAmount"},{id:6,title:"Due Amount",dataIndex:"dueAmount",key:"dueAmount"}];return e.jsx("div",{className:"card card-custom mt-3 ",children:e.jsx("div",{className:"card-body",children:e.jsx(z,{className:"max-md:border-0 max-md:bg-white",bodyClass:"max-md:p-0 ",headClass:"border-none",title:"Purchase Report",children:o?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between p-5 items-start ",children:[e.jsx("div",{children:e.jsx(N,{onClick:()=>l(s=>!s),className:"bg-gray-500 text-white",children:"Generate Again"})}),e.jsxs("div",{className:"flex px-5 gap-2 items-center ",children:[e.jsx($,{data:t,title:"Purchase Report",pageConfig:n,type:"print",btnName:"Print",info:h,supplier:c}),e.jsx($,{data:t,title:"Purchase Report",pageConfig:n,info:h,type:"download",btnName:"Export PDF",supplier:c}),e.jsx("div",{children:e.jsx(E,{list:t,columns:x,title:"Purchase Report",className:"bg-primary   h-auto py-2 ",btnName:"Export CSV"})})]})]}),e.jsx(O,{list:t,columns:x,loading:d})]}):e.jsx(G,{pageConfig:n,setSupplier:i,setShowTable:l,setPageConfig:D})})})})}export{K as default};
